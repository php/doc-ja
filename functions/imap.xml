 <reference id="ref.imap">
  <title>IMAP,POP3,NNTP関数</title>
  <titleabbrev>IMAP</titleabbrev>

   <partintro>
   <simpara>
    これらの関数を動作させるには、<option
    role="configure">--with-imap</option>を付けて PHP をコンパイルする
    必要があります。この際に、C クライアントライブラリが必要となります。
    最新版を <ulink url="&url.imap;">&url.imap;</ulink>から取得し、
    コンパイルして下さい。
    その後、<filename>c-client/c-client.a</filename>を<filename>
    /usr/local/lib/libc-client.a</filename>またはリンクパスが通った
    他のディレクトリにコピーし、<filename>c-client/rfc822.h</filename>, 
    <filename>mail.h</filename>,<filename>linkage.h</filename>を
    <filename>/usr/local/include</filename>またはインクルードパスが通った
    他のディレクトリにコピーして下さい。
   </simpara>
   <simpara>
    IMAP関数がサポートするのは、その名前から連想されるようにIMAPプロト
    コルに限定されているわけではないということに注意して下さい。実際の
    処理を行うCクライアントライブラリは、<acronym>NNTP</acronym>、
    <acronym>POP3</acronym>、ローカルなメールボックスへのアクセスもサ
    ポートしています。
   </simpara>
   <para>
    この文書では、提供される関数に関する全ての話題の詳細について立ち入
    ることはできません。より詳細な情報については、Cクライアントライブ
    ラリのソースに付属するドキュメント
    (<filename>docs/internal.txt</filename>)および以下のRFCドキュメン
    トで提供されています。
    <itemizedlist>
     <listitem>
      <simpara>
       <ulink url="&url.rfc;rfc821.html">RFC821</ulink> :
       Simple Mail Transfer Protocol (SMTP)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <ulink url="&url.rfc;rfc822.html">RFC822</ulink> :
       Standard for ARPA internet text messages
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <ulink url="&url.rfc;rfc2060.html">RFC2060</ulink> :
       Internet Message Access Protocol (IMAP) Version 4rev1 
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <ulink url="&url.rfc;rfc1939.html">RFC1939</ulink> : 
       Post Office Protocol Version 3 (POP3)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <ulink url="&url.rfc;rfc977.html">RFC977</ulink> :
       Network News Transfer Protocol (NNTP)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <ulink url="&url.rfc;rfc2076.html">RFC2076</ulink> :
       Common Internet Message Headers
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <ulink url="&url.rfc;rfc2045.html">RFC2045</ulink> ,
       <ulink url="&url.rfc;rfc2046.html">RFC2046</ulink> ,
       <ulink url="&url.rfc;rfc2047.html">RFC2047</ulink> ,
       <ulink url="&url.rfc;rfc2048.html">RFC2048</ulink> &amp;
       <ulink url="&url.rfc;rfc2049.html">RFC2049</ulink> :
       Multipurpose Internet Mail Extensions (MIME) 
      </simpara>
     </listitem>
    </itemizedlist>
    詳しい概観については、David Woodによる本
    <ulink url="&url.email.book;">Programming Internet Email</ulink>
    や Dianna Mullet と Kevin Mullet による<ulink
    url="&url.imap.book;">Managing IMAP</ulink>でも得ることができます。
   </para>
  </partintro>
 
  <refentry id="function.imap-append">
   <refnamediv>
    <refname>imap_append</refname>
    <refpurpose>
     指定されたメールボックスに文字列メッセージを追加する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_append</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>mbox</parameter></paramdef>
      <paramdef>string <parameter>message</parameter></paramdef>
      <paramdef>string
       <parameter><optional>flags</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
    <para>  
     <function>imap_append</function> は、文字列メッセージを指定した
     メールボックス<parameter>mbox</parameter> に追加します。
     オプションの <parameter>flags</parameter> が指定された場合、
     <parameter>flags</parameter> もそのメールボックスに書きこまれます。
    </para>
    <para>
     Cyrus IMAP サーバーと通信する際には、改行コードとして "\n" の替わ
     りに"\r\n" と使用する必要があります。さもなくば、操作は失敗します。
    </para>
    <para>     
     <example>
      <title><function>imap_append</function>の例</title>
      <programlisting>
<?php
$stream = imap_open("{your.imap.host}INBOX.Drafts","username", "password");

$check = imap_check($stream);
print "Msg Count before append: ". $check->Nmsgs."\n";

imap_append($stream,"{your.imap.host}INBOX.Drafts"
                   ,"From: me@my.host\r\n"
                   ."To: you@your.host\r\n"
                   ."Subject: test\r\n"
                   ."\r\n"
                   ."this is a test message, please ignore\r\n"
                   );

$check = imap_check($stream);
print "Msg Count after append : ". $check->Nmsgs."\n";

imap_close($stream);
?>
      </programlisting>
     </example>
    </para>
  </refsect1>
  </refentry>

  <refentry id="function.imap-base64">
   <refnamediv>
    <refname>imap_base64</refname>
    <refpurpose>BASE64 でエンコードされたテキストのデコード</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_base64</function></funcdef>
      <paramdef>string <parameter>text</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <function>imap_base64</function>  関数は、BASE64 でエンコードされ
     たテキストをデコードします。(<ulink
     url="&url.rfc;rfc2045.html">RFC2045</ulink>, Section 6.8を参照下
     さい。)デコードされたメッセージは文字列として返されます。
    </para>
    <para>
     <function>imap_binary</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-body">
   <refnamediv>
    <refname>imap_body</refname>
    <refpurpose>メッセージ本文を読む</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_body</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int <parameter>msg_number</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>flags</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <function>imap_body</function>は、現在のメールボックスにある 
     <parameter>msg_number</parameter> 番目のメッセージの本文を返します。
     オプションの <parameter>flags</parameter> はビットマスクであり、
     以下の要素の組み合わせとなってます。
     <itemizedlist>
      <listitem>
       <simpara>
	FT_UID - <parameter>msgno</parameter>はUIDです
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	FT_PEEK - 既に設定されていない場合、\Seen フラグを設定しない
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	FT_INTERNAL - 内部フォーマットで文字列を返す。CRLF には適用されない。
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     <function>imap_body</function> は、メッセージボディーと全く同じコ
     ピーのみを返します。マルチパートMIMEエンコードされたメッセージの
     一部を展開するには、その構造を解析するために
     <function>imap_fetch_structure</function>を使用し、単一のボディー
     要素のコピーを展開する際には、
     <function>imap_fetch_body</function>を使用する必要があります。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-check">
   <refnamediv>
    <refname>imap_check</refname>
    <refpurpose>現在のメールボックスをチェックする</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>object <function>imap_check</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     現在のメールボックスに関する情報を返します。失敗した場合は、false
     を返します。
    </para>
    <para>  
     <function>imap_check()</function> 関数は、サーバ上の現在のメールボックス
     のステータスをチェックし、その情報を以下のプロパティを有するオブジェクト
     として返します。
    </para>
    <para>
    <itemizedlist>
     <listitem>
      <simpara>
       Date - メールボックスの内容の最終変更日
      </simpara>
     </listitem>
     <listitem>
      <simpara>	
       Driver - メールボックスにアクセスする際に使用するプロトコル: POP3, IMAP, NNTP  
      </simpara>
     </listitem>
     <listitem>
      <simpara>	
       Mailbox - メールボックスの名前
      </simpara>
     </listitem>
     <listitem>
      <simpara>	
       Nmsgs - メールボックス内のメッセージの数
      </simpara>
     </listitem>
     <listitem>
      <simpara>	
       Recent - メールボックス内の新規メッセージの数
      </simpara>
     </listitem>
    </itemizedlist>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-close">
   <refnamediv>
    <refname>imap_close</refname>
    <refpurpose>IMAP ストリームをクローズする</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_close</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>flags</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     IMAP ストリームをクローズします。
     オプション<parameter>flag</parameter>にCL_EXPUNGEを指定した場合、
     メールボックスを閉じる前に暗黙のうちに
     削除マークがついた全てのメッセージが削除されます。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-createmailbox">
   <refnamediv>
    <refname>imap_createmailbox</refname>
    <refpurpose>新しいメールボックスを作る</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_createmailbox</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>mbox</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     <function>imap_createmailbox</function>は<parameter>mbox</parameter> 
     で指定された新しいメールボックスを作成します。この名前に国際化文
     字を含む場合には、<function>imap_utf7_encode</function>でエンコー
     ドする必要があります。
    </para>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
    <para>
     <parameter>mbox</parameter>の名前のフォーマット形式に関しては
     <function>imap_renamemailbox</function>,
     <function>imap_deletemailbox</function>,
     <function>imap_open</function>も参照下さい。
    </para>
    <para>     
     <example>
      <title><function>imap_createmailbox</function> の例</title>
      <programlisting role="php">
$mbox = imap_open ("{your.imap.host}","username","password",OP_HALFOPEN)
     || die ("can't connect: ".imap_last_error());

$name1 = "phpnewbox";
$name2 = imap_utf7_encode ("phpnewb&ouml;x");

$newname = $name1;

echo "Newname will be '$name1'&lt;br>\n";

# 新規のメールボックス "phptestbox" を inbox フォルダ内に作成し、作成
# 後にそのステータスをチェックします。最後に初期状態に戻すためにそのメー
# ルボックスを削除します。
if(@imap_createmailbox($mbox,imap_utf7_encode("{your.imap.host}INBOX.$newname"))) {
  $status = @imap_status($mbox,"{your.imap.host}INBOX.$newname",SA_ALL);
  if($status) {
    print("your new mailbox '$name1' has the following status:&lt;br>\n");
    print("Messages:   ". $status->messages   )."&lt;br>\n";
    print("Recent:     ". $status->recent     )."&lt;br>\n";
    print("Unseen:     ". $status->unseen     )."&lt;br>\n";
    print("UIDnext:    ". $status->uidnext    )."&lt;br>\n";
    print("UIDvalidity:". $status->uidvalidity)."&lt;br>\n";
    
    if(imap_renamemailbox($mbox,"{your.imap.host}INBOX.$newname","{your.imap.host}INBOX.$name2")) {
      echo "renamed new mailbox from '$name1' to '$name2'&lt;br>\n";
      $newname=$name2;
    } else {
      print "imap_renamemailbox on new mailbox failed: ".imap_last_error()."&lt;br>\n";
    }
  } else {
    print  "imap_status on new mailbox failed: ".imap_last_error()."&lt;br>\n";
  }
  if(@imap_deletemailbox($mbox,"{your.imap.host}INBOX.$newname")) {
    print "new mailbox removed to restore initial state&lt;br>\n";
  } else {
    print  "imap_deletemailbox on new mailbox failed: ".implode("&lt;br>\n",imap_errors())."&lt;br>\n";
  }
  
} else {
  print  "could not create new mailbox: ".implode("&lt;br>\n",imap_errors())."&lt;br>\n";
}

imap_close($mbox);
      </programlisting>
     </example>
    </para>     
   </refsect1>
  </refentry>

  <refentry id="function.imap-delete">
   <refnamediv>
    <refname>imap_delete</refname>
    <refpurpose>
     現在のメールボックスから削除するメッセージに印を付ける
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_delete</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int <parameter>msg_number</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>flags</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     trueを返します。
    </para>
    <para>
     <function>imap_delete</function> 関数は、
     <parameter>msg_number</parameter>が指す削除する予定のメッセージを
     マークします。オブションのパラメータ<parameter>flags</parameter>
     で指定可能なオプションは<parameter>FT_UID</parameter>のみです。
     このオプションは、引数<parameter>msg_number</parameter>を
     <parameter>UID</parameter>として処理することを関数に指定します。
     削除マークを付けられたメッセージは、
     <function>imap_expunge</function>がコールされるか
     <function>imap_close</function>にCL_EXPUNGEを付けてコールされるか
     のどちらかが行われるまでメールボックスに残ったままになります。
    </para>
    <para>     
     <example>
      <title><function>imap_delete</function>の例</title>
      <programlisting role="php">
$mbox = imap_open ("{your.imap.host}INBOX", "username", "password")
    || die ("can't connect: " . imap_last_error());

$check = imap_mailboxmsginfo ($mbox);
print "Messages before delete: " . $check->Nmsgs . "&lt;br>\n" ;
imap_delete ($mbox, 1);
$check = imap_mailboxmsginfo ($mbox);
print "Messages after  delete: " . $check->Nmsgs . "&lt;br>\n" ;
imap_expunge ($mbox);
$check = imap_mailboxmsginfo ($mbox);
print "Messages after expunge: " . $check->Nmsgs . "&lt;br>\n" ;
imap_close ($mbox);
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-deletemailbox">
   <refnamediv>
    <refname>imap_deletemailbox</refname>
    <refpurpose>メールボックスを削除する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_deletemailbox</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>mbox</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     <function>imap_deletemailbox</function> は指定されたメールボック
     スを削除します。(<parameter>mbox</parameter>名の形式については
     <function>imap_open</function>を参照下さい)
    </para>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
    <para>
     <function>imap_createmailbox</function>、
     <function>imap_renamemailbox</function>、
     <parameter>mbox</parameter>のフォーマットについては
     <function>imap_open</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-expunge">
   <refnamediv>
    <refname>imap_expunge</refname>
    <refpurpose>
     削除用にマークされたすべてのメッセージを削除する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_expunge</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     <function>imap_expunge</function> は、
     <function>imap_delete</function>,<function>imap_mail_move</function>,
     <function>imap_setflag_full</function>で削除用マークを設定された
     すべてのメッセージを削除します。
    </para>
    <para>
     trueを返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-fetchbody">
   <refnamediv>
    <refname>imap_fetchbody</refname>
    <refpurpose>メッセージ本文中の特定のセクションを取り出す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_fetchbody</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int <parameter>msg_number</parameter></paramdef>
      <paramdef>string <parameter>part_number</parameter></paramdef>
      <paramdef>flags 
       <parameter>
        <optional>flags</optional>
       </parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、指定されたメッセージ本文中の特定のセクションをテキスト
     文字列として取り出し、そのテキスト文字列を返します。セクション指定
     はピリオドで区切られた整数文字列で行い、この整数は IMAP4 仕様における
     本文パートのリストへのインデックスとなります。本文パートはこの関
     数ではデコードされません。
    </para>
    <para>
     <function>imap_fetchbody </function> の オプション
     <parameter>flags</parameter>
     はビットマスクであり、以下の組合わせとなります。
     <itemizedlist>
      <listitem>
       <simpara>
        FT_UID - <parameter>msg_number</parameter>は UID である
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        FT_PEEK - 既に設定されていない場合、\Seen フラグを設定しない
       </simpara>
      </listitem>
      <listitem>
       <simpara>
 	FT_INTERNAL - 内部フォーマットで文字列を返す。CRLF には適用されない。
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-fetchstructure">
   <refnamediv>
    <refname>imap_fetchstructure</refname>
    <refpurpose>
     特定のメッセージの構造を読み込む
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>object <function>imap_fetchstructure</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int <parameter>msg_number</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>flags</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、指定したメッセージに関するすべての構造化された情報を
     取り出します。オプションのパラメータ <parameter>flags</parameter>
     に指定可能なのは<parameter>FT_UID</parameter>のみで、これは、引数
     <parameter>msg_number</parameter> を<parameter>UID</parameter> と
     して処理することを関数に指定するためのものです。返されるオブジェ
     クトは、MIMEの添付の各要素に類似のオブジェクトとしてエンベロープ、
     内部の日付、サイズ、フラグ、本体を含んでいます。返されるオブジェ
     クトの構造は次のようになります。
    </para>
    <para>
     <table>
      <title>
       <function>imap_fetchstructure</function>で返されるオブジェクト
      </title>
      <tgroup cols="2">
       <tbody>
	<row>
	 <entry>type</entry>
 	 <entry>最初のbody部の型</entry>
 	</row>
 	<row>
 	 <entry>encoding</entry>
 	 <entry>body部を転送する際のエンコード法</entry>
 	</row>
 	<row>
 	 <entry>ifsubtype</entry>
 	 <entry>subtype文字列がある場合にtrue</entry>
 	</row>
 	<row>
 	 <entry>subtype</entry>
 	 <entry><acronym>MIME</acronym> の subtype</entry>
 	</row>
 	<row>
 	 <entry>ifdescription</entry>
 	 <entry>description文字列がある場合にtrue</entry>
 	</row>
 	<row>
 	 <entry>description</entry>
 	 <entry>内容を記述する文字列</entry>
 	</row>
 	<row>
 	 <entry>ifid</entry>
 	 <entry>identification 文字列がある場合にtrue</entry>
 	</row>
 	<row>
 	 <entry>id</entry>
 	 <entry>identification 文字列</entry>
 	</row>
 	<row>
 	 <entry>lines</entry>
 	 <entry>行数</entry>
 	</row>
 	<row>
 	 <entry>bytes</entry>
 	 <entry>バイト数</entry>
 	</row>
 	<row>
 	 <entry>ifdisposition</entry>
 	 <entry>disposition 文字列がある場合にtrue</entry>
 	</row>
 	<row>
 	 <entry>disposition</entry>
 	 <entry>disposition 文字列</entry>
 	</row>
 	<row>
 	 <entry>ifdparameters</entry>
 	 <entry>dparameters 配列が存在する場合に true</entry>
 	</row>
 	<row>
 	 <entry>dparameters</entry>
 	 <entry>特性パラメータ配列</entry>
 	</row>
 	<row>
 	 <entry>ifparameters</entry>
 	 <entry>配列parametersが存在する場合にtrue</entry>
 	</row>
 	<row>
 	 <entry>parameters</entry>
 	 <entry><acronym>MIME</acronym> パラメータ配列</entry>
 	</row>
 	<row>
 	 <entry>parts</entry>
 	 <entry>各メッセージパートを記述するオブジェクトの配列</entry>
 	</row>
       </tbody>
      </tgroup>
     </table>
    </para>
    <note>
     <orderedlist>
      <listitem>
       <para>
	dparametersはオブジェクトの配列です。
	各オブジェクトはプロパティ"attribute"および"value"を有しています。
       </para>
      </listitem>
      <listitem>
       <para>
	parameterはオブジェクトの配列です。
	各オブジェクトはプロパティ"attribute"および"value"を有しています。
       </para>
      </listitem>
      <listitem>
       <para>
	partsはオブジェクトの配列であり、その構造はトップレベルオブジェクト
	と同じです。ただし、'parts'オブジェクトを更に追加できないという制限
	があります。
       </para>
      </listitem>
     </orderedlist>
    </note>
    <para>
     <table>
      <title>最初のボディーの型</title>
      <tgroup cols="2">
       <tbody>
        <row><entry>0</entry><entry>text</entry></row>
        <row><entry>1</entry><entry>multipart</entry></row>
        <row><entry>2</entry><entry>message</entry></row>
        <row><entry>3</entry><entry>application</entry></row>
        <row><entry>4</entry><entry>audio</entry></row>
        <row><entry>5</entry><entry>image</entry></row>
        <row><entry>6</entry><entry>video</entry></row>
        <row><entry>7</entry><entry>other</entry></row>
       </tbody>
       </tgroup>
     </table>
    </para>
    <para>
     <table>
       <title>通信時のエンコーディング</title>
       <tgroup cols="2">
        <tbody>
        <row><entry>0</entry><entry>7BIT</entry></row>
        <row><entry>1</entry><entry>8BIT</entry></row>
        <row><entry>2</entry><entry>BINARY</entry></row>
        <row><entry>3</entry><entry>BASE64</entry></row>
        <row><entry>4</entry><entry>QUOTED-PRINTABLE</entry></row>
        <row><entry>5</entry><entry>OTHER</entry></row>
        </tbody>
       </tgroup>
     </table>
    </para>
  </refsect1>
  </refentry>

  <refentry id="function.imap-headerinfo">
   <refnamediv>
    <refname>imap_headerinfo</refname>
    <refpurpose>メッセージヘッダを読み込む</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>object <function>imap_headerinfo</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int <parameter>msg_number</parameter></paramdef>
      <paramdef>int 
        <parameter><optional>fromlength</optional></parameter>
      </paramdef>
      <paramdef>int 
        <parameter><optional>subjectlength</optional></parameter>
      </paramdef>
      <paramdef>string 
        <parameter><optional>defaulthost</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
    この関数は、様々なヘッダー要素を有するオブジェクトを返します。
    </para>
    <para>  
     <informalexample>
      <literallayout>
        remail,date,Date,subject,Subject,in_reply_to,message_id,newsgroups,
        followup_to,references

 message flags:
   Unseen - 'U' if unseen, ' ' if seen
   Answered - 'A' if answered, ' ' if unanswered
   Deleted - 'D' if deleted, ' ' if not deleted
   Draft - 'X' if draft, ' ' if not draft
   Flagged - 'F' if flagged, ' ' if not flagged

 toaddress (to: 行?、最大 1024 文字)
 
 to[] (TO 行から、以下の要素を含むオブジェクト配列を返します)
    personal
    adl
    mailbox
    host
 
 fromaddress (from: 行全体、最大 1024 文字)
 
 from[] (From 行から、以下の要素を含むオブジェクト配列を返します)
    personal
    adl
    mailbox
    host
 
 ccaddress (cc: 行全体、最大 1024 文字)
 cc[] (Cc 行から、以下の要素を含むオブジェクト配列を返します)
    personal
    adl
    mailbox
    host
 
 bccaddress (bcc: 行全体、最大 1024 文字)(full bcc line, up to 1024 characters)
 bcc[] (Bcc 行から、以下の要素を含むオブジェクト配列を返します)
    personal
    adl
    mailbox
    host
 
 reply_toaddress (reply_to: 行全体、最大 1024 文字)
 reply_to[] (Reply_to 行から、以下の要素を含むオブジェクト配列を返します)
    personal
    adl
    mailbox
    host
 
 senderaddress (sender: 行全体、最大 1024 文字)
 sender[] (sender 行から、以下の要素を含むオブジェクト配列を返します)
    personal
    adl
    mailbox
    host
 
 return_path (return-path: 行全体、最大 1024 文字)
 return_path[] (return_path 行から、以下の要素を含むオブジェクト配列を返します)
    personal
    adl
    mailbox
    host
  
 udate ( UNIX 時間で表した mail メッセージの日付)
  
 fetchfrom (<parameter>fromlength</parameter> 文字に適合するようフォーマットされた from 行)
 fetchsubject (<parameter>subjectlength</parameter> 文字に適合するようフォーマットされた subject 行)
      </literallayout>
     </informalexample>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-header">
   <refnamediv>
    <refname>imap_header</refname>
    <refpurpose>メッセージのヘッダを読む</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcdef>object <function>imap_header</function></funcdef>
     <paramdef>int <parameter>imap_stream</parameter></paramdef>
     <paramdef>int <parameter>msg_number</parameter></paramdef>
     <paramdef>int 
      <parameter><optional>fromlength</optional></parameter>
     </paramdef>
     <paramdef>int 
      <parameter><optional>subjectlength</optional></parameter>
     </paramdef>
     <paramdef>string 
      <parameter><optional>defaulthost</optional></parameter>
     </paramdef>
    </funcsynopsis>
    <para>
     この関数は、<function>imap_headerinfo</function>へのエイリアスで
     あり、全く同様に動作します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-rfc822-parse-headers">
   <refnamediv>
    <refname>imap_rfc822_parse_headers</refname>
    <refpurpose>文字列からメールヘッダを解釈する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>object <function>imap_rfc822_parse_headers</function></funcdef>
      <paramdef>string <parameter>headers</parameter></paramdef>
      <paramdef>string 
       <parameter><optional>defaulthost</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は複数のヘッダ要素を有するオブジェクトを返します。
     この関数は<function>imap_header</function>に似ていますが、
     フラグおよび他の要素はIMAPサーバーから取得されるところが異なります。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-headers">
   <refnamediv>
    <refname>imap_headers</refname>
    <refpurpose>
     メールボックス内の、すべてのメッセージのヘッダを返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_headers</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     ヘッダ情報でフォーマットされた文字列の配列を返します。1 つの
     メールメッセージ毎に 1 つの要素が格納されます。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-listmailbox">
   <refnamediv>
    <refname>imap_listmailbox</refname>
    <refpurpose>メールボックスのリストを読む</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_listmailbox</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>ref</parameter></paramdef>
      <paramdef>string <parameter>pattern</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     メールボックス名を保持する配列を返します。
     <parameter>ref</parameter>および<parameter>pattern</parameter>
     の説明については、<function>imap_getmailboxes</function>を参照下さい。
    </para>
    <para>
     <example>
      <title><function>imap_listmailbox</function> の例</title>
      <programlisting role="php">
$mbox = imap_open("{your.imap.host}","username","password",OP_HALFOPEN)
      || die("can't connect: ".imap_last_error());
 
$list = imap_listmailbox($mbox,"{your.imap.host}","*");
if(is_array($list)) {
  reset($list);
  while (list($key, $val) = each($list))
    print imap_utf7_decode($val)."&lt;br>\n";
} else
  print "imap_listmailbox failed: ".imap_last_error()."\n";
 
imap_close($mbox);                                                                
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-getmailboxes">
   <refnamediv>
    <refname>imap_getmailboxes</refname>
    <refpurpose>
     メールボックスのリストを読み込み、各ボックスに関する詳細な情報を返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_getmailboxes</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>ref</parameter></paramdef>
      <paramdef>string <parameter>pattern</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
    メールボックス情報を有するオブジェクトの配列を返します。各オブジェクトは、
    メールボックスの完全な名前である <parameter>name</parameter>、
    このメールボックスの階層の区切りを示す属性<parameter>delimiter</parameter>、
     <parameter>attributes</parameter>を有しています。
    <parameter>attributes</parameter> はビットマスクであり、次のものについて
    調べることができます。
    <itemizedlist>
     <listitem>
      <simpara>
	LATT_NOINFERIORS - このメールボックスは "子" を有しません 
	                   (このボックスの中にメールボックスはありません。)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
	LATT_NOSELECT - 単なるコンテナであり、メールボックスではありません。
	                これをオープンすることはできません。
      </simpara>
     </listitem>
     <listitem>
      <simpara>
	LATT_MARKED - このメールボックスには印が付けられています。
	              UW-IMAPD でのみ使用されます。
      </simpara>
     </listitem>
     <listitem>
      <simpara>
	LATT_UNMARKED - このメールボックスはマークされていません。
	                UW-IMAPD でのみ必要です。
      </simpara>
     </listitem>
    </itemizedlist>
    </para>
    <para>
     通常、<parameter>ref</parameter> は、{imap_server:imap_port} 形式の
     IMAP サーバーとする必要があります。
     また、<parameter>pattern</parameter> により検索を開始するメールボックスの
     階層を指定します。
     全てのメールボックスを検索したい場合には、<parameter>pattern</parameter>
     に'*'を指定して下さい。
    </para>
    <para>
     <parameter>pattern</parameter> の中で使用できる特別な文字として
     '*' および '%' があります。'*' は、全てのメールボックスを意味しま
     す。<parameter>pattern</parameter> に '*' を指定した場合、メール
     ボックス階層全体のリストが得られます。'%' は現在のレベルのみを意
     味します。'%' を <parameter>pattern</parameter>に指定した場合、トッ
     プレベルのメールボックスのみが返されます。UW_IMAPD を使用した場
     合、'~/mail/%' は ~/mail ディレクトリの全てのメールボックスを返し
     ますが、そのディレクトリのサブフォルダーにあるメールボックスは返
     しません。
    </para>
    <para>
     <example>
      <title><function>imap_getmailboxes</function> の例</title>
      <programlisting role="php">
$mbox = imap_open("{your.imap.host}","username","password",OP_HALFOPEN)
      || die("can't connect: ".imap_last_error());
 
$list = imap_getmailboxes($mbox,"{your.imap.host}","*");
if(is_array($list)) {
  reset($list);
  while (list($key, $val) = each($list))
  {
    print "($key) ";
    print imap_utf7_decode($val->name).",";
    print "'".$val->delimiter."',";
    print $val->attributes."&lt;br>\n";
  }
} else
  print "imap_getmailboxes failed: ".imap_last_error()."\n";
 
imap_close($mbox);                                                                
      </programlisting>
     </example>
    </para>
    <para>
     <function>imap_getsubscribed</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-listsubscribed">
   <refnamediv>
    <refname>imap_listsubscribed</refname>
    <refpurpose>購読中のすべてのメールボックス一覧</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_listsubscribed</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>ref</parameter></paramdef>
      <paramdef>string <parameter>pattern</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     購読中のすべてのメールボックスの配列を返します。
     この関数はほぼ<function>imap_listmailbox</function>と同じですが、
     自分がログインしているユーザーが購読中のメールボックスのみを
     返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-getsubscribed">
   <refnamediv>
    <refname>imap_getsubscribed</refname>
    <refpurpose>購読中の全メールボックスの一覧</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_getsubscribed</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>ref</parameter></paramdef>
      <paramdef>string <parameter>pattern</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、ユーザーが購読しているメールボックスのみを返すことを除き、
     <function>imap_getmailboxes</function> と同じ動作をします。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-mail-copy">
   <refnamediv>
    <refname>imap_mail_copy</refname>
    <refpurpose>指定されたメッセージをメールボックスにコピーする
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_mail_copy</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>msglist</parameter></paramdef>
      <paramdef>string <parameter>mbox</parameter></paramdef>
      <paramdef>int 
       <parameter>
        <optional>flags</optional>
       </parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
    <para>
     <parameter>msglist</parameter> で指定されたメッセージを、指定した
     メールボックスにコピーします。<parameter>msglist</parameter> は、
     (<ulink url="&url.rfc;rfc2060.html">RFC2060</ulink>に記述されたよ
     うに)ただのメッセージ番号ではなく、範囲を示します。
    </para>
    <para> 
     flags はビットマスクであり、以下の組み合わせです。
     <itemizedlist>
      <listitem>
       <simpara>
 	CP_UID - UIDS を含む処理の数
       </simpara>
      </listitem>
      <listitem>
       <simpara>
 	CP_MOVE - コピー後にメールボックスからメッセージを削除
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-mail-move">
   <refnamediv>
    <refname>imap_mail_move</refname>
    <refpurpose>
     指定されたメッセージをメールボックスに移動する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_mail_move</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>msglist</parameter></paramdef>
      <paramdef>string <parameter>mbox</parameter></paramdef>
      <paramdef>int 
       <parameter>
        <optional>flags</optional>
       </parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     <parameter>msglist</parameter> で指定されたメッセージを、指定された
     メールボックスに移動します。<parameter>msglist</parameter> は
     単なるメッセージ番号でなく、
     (<ulink url="&url.rfc;rfc2060.html">RFC2060</ulink>で解説された)
     メッセージの範囲を指定します。
    </para>
    <para>
     flagsはビットマスクであり、指定できるオプションは1つだけです。
     <itemizedlist>
      <listitem>
       <simpara>
	CP_UID - シーケンス番号にUIDを含む
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-num-msg">
   <refnamediv>
    <refname>imap_num_msg</refname>
    <refpurpose>
     現在のメールボックスのメッセージ数を取得する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_num_msg</function></funcdef>
      <paramdef>int <parameter>stream_id</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     現在のメールボックスにあるメッセージ数を返します。
    </para>
   </refsect1>
  </refentry>


  <refentry id="function.imap-num-recent">
   <refnamediv>
    <refname>imap_num_recent</refname>
    <refpurpose>現在のメールボックスにある新規メッセージの数の取得</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_num_recent</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     現在のメールボックスにある新しいメッセージの数を返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-open">
   <refnamediv>
    <refname>imap_open</refname>
    <refpurpose>
     メールボックスへのIMAPストリームをオープンする
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_open</function></funcdef>
      <paramdef>string <parameter>mailbox</parameter></paramdef>
      <paramdef>string <parameter>username</parameter></paramdef>
      <paramdef>string <parameter>password</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>flags</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     成功するとIMAPストリームを返し、失敗するとfalseを返します。この関
     数は、POP3やNNTPサーバーへのストリームをオープンする際にも使用可
     能です。しかし、いくつかの関数および機能はIMAPサーバーでは利用で
     きません。
    </para>
    <para>
     メールボックス名(mailbox)は、サーバー名の部分と使用するサーバーに
     おけるメールボックスへのパスから構成されます。特別な名前INBOXは、
     カレントのユーザの個人メールボックスを意味します。サーバー部は'{'
     および'}'で括られ、サーバー名またはIPアドレス、('/'で始まる)プロ
     トコル指定、そして':'から始まるオプションのポート指定子から構成さ
     れます。サーバー部は、全てのmailboxパラメータで必須です。
     ASCII空間で出力可能な文字以外の外国文字を含むメールボックス名は
     <function>imap_utf7_encode</function>でエンコードする必要がありま
     す。
    </para>
    <para>
     オプションは、ビットマスクであり、以下の組み合わせとなります。
     <itemizedlist>
      <listitem>
       <simpara>
	OP_READONLY - メールボックスを読みこみのみ可でオープン
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	OP_ANONYMOUS - news に関して.newsrcの使用・更新をしない(NNTPのみ)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	OP_HALFOPEN - IMAPおよびNNTP名について、接続をオープンするがメールボックスをオープンしない
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	CL_EXPUNGE - メールボックスを閉じた際に、自動的にメールボックスを削除する
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     ローカルマシンのポート143で実行しているIMAPサーバーに接続
     する際には、以下のようにします。
     <informalexample>
      <programlisting role="php">
$mbox = imap_open ("{localhost:143}INBOX","user_id","password");
      </programlisting>
     </informalexample>
      ローカルマシンのポート110で実行しているPOP3サーバーに接続する際には、
     以下のようにします。
     <informalexample>
      <programlisting>
$mbox = imap_open ("{localhost/pop3:110}INBOX","user_id","password");
      </programlisting>
     </informalexample>
     ローカルマシンのポート119で実行しているNNTPサーバーに接続する際には、
     以下のようにします。
     <informalexample>
      <programlisting>
$nntp = imap_open ("{localhost/nntp:119}comp.test","","");
      </programlisting>
     </informalexample>
     リモートサーバーに接続するには、"localhost" を接続したいサーバーの
     名前または IP アドレスに代えてください。
    </para>
    <para>
     <example>
      <title><function>imap_open</function>の例</title>
      <programlisting>
$mbox = imap_open("{your.imap.host:143}","username","password");

echo "&lt;p&gt;&lt;h1&gt;Mailboxes&lt;/h1&gt;\n";
$folders = imap_listmailbox($mbox, "{your.imap.host:143}", "*");
if($folders == false)
  echo "Call failed&lt;br&gt;\n";
else
  while(list($key,$val) = each($folders))
    echo $val."&lt;br&gt;\n";

echo "&lt;p&gt;&lt;h1&gt;Headers in INBOX&lt;/h1&gt;\n";
$headers = imap_headers($mbox);
if($headers == false)
  echo "Call failed&lt;br&gt;\n";
else
  while(list($key,$val) = each($headers))
    echo $val."&lt;br&gt;\n";

imap_close($mbox);
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-ping">
   <refnamediv>
    <refname>imap_ping</refname>
    <refpurpose>IMAP ストリームの有効性チェック</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_ping</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     ストリームがまだ有効であればtrueを、そうでなければfalseを返します。
    </para>
    <para>
     <function>imap_ping</function> 関数は、ストリームに ping を行い、
     まだ有効であるかどうかをチェックします。これにより新しいメールの到着
     を知る場合もあります。これは、有効時間のタイムアウトが設定
     してあるサーバに対して "接続を持続させる" ことに加え、定期的な
     "新着メールのチェック" としてもよい方法です。
     (PHPスクリプトはこれほどの長時間実行されることはほとんどないので、
     この関数が実際に役に立つかどうかは定かではありません。)
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-renamemailbox">
   <refnamediv>
    <refname>imap_renamemailbox</refname>
    <refpurpose>メールボックスの名前を変更する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_renamemailbox</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>old_mbox</parameter></paramdef>
      <paramdef>string <parameter>new_mbox</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     この関数は、古いメールボックスを新しいメールボックスにリネーム
     します。 (<parameter>mbox</parameter>名のフォーマットについては
     <function>imap_open</function>を参照下さい)
    </para>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
    <para>
     <parameter>mbox</parameter>のフォーマットについては、
     <function>imap_createmailbox</function>,
     <function>imap_deletemailbox</function>,
     <function>imap_open</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-reopen">
   <refnamediv>
    <refname>imap_reopen</refname>
    <refpurpose>新規メールボックスへのIMAP ストリームを再度オープンする
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_reopen</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>mailbox</parameter></paramdef>
      <paramdef>string
       <parameter><optional>flags</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
    <para>  
     この関数は、IMAPまたはNNTPサーバー上の新しいメールボックスに対して
     指定されたストリームを再オープンします。
    </para>
    <para>
     オプションは、ビットマスクであり、以下の組み合わせとなります。
     <itemizedlist>
      <listitem>
       <simpara>
 	OP_READONLY - メールボックスを読みこみのみ可でオープン
       </simpara>
      </listitem>
      <listitem>
       <simpara>
 	OP_ANONYMOUS - news に関して .newsrc の使用・更新をしない (NNTPのみ)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
 	OP_HALFOPEN - IMAP および NNTP 名について、接続をオープンするが
	              メールボックスをオープンしない
       </simpara>
      </listitem>
      <listitem>
       <simpara>
 	CL_EXPUNGE - メールボックスを閉じた際に、自動的にメールボック
 	スを削除する (<function>imap_delete</function>および
	<function>imap_expunge</function>も参照下さい )
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     成功時にtrue、エラー時にfalseを返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-subscribe">
   <refnamediv>
    <refname>imap_subscribe</refname>
    <refpurpose>メールボックスの購読</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_subscribe</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>mbox</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     新規メールボックスを購読します。
    </para>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-undelete">
   <refnamediv>
    <refname>imap_undelete</refname>
    <refpurpose>削除マークがついているメッセージのマークをはずす</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_undelete</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int <parameter>msg_number</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     この関数は、<function>imap_delete</function>または
     <function>imap_mail_move</function>によりセットされた指定されたメッ
     セージの削除フラグをはずします。
    </para>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-unsubscribe">
   <refnamediv>
    <refname>imap_unsubscribe</refname>
    <refpurpose>メールボックスの購読をやめる</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_unsubscribe</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>mbox</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     指定されたメールボックスの購読を中止します。
    </para>
    <para>
     成功するとtrue、失敗するとfalseを返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-qprint">
   <refnamediv>
    <refname>imap_qprint</refname>
    <refpurpose>quoted-printable 文字列を 8 ビット文字列に変換する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_qprint</function></funcdef>
      <paramdef>string <parameter>string</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     (<ulink url="&url.rfc;rfc2045.html">RFC2045</ulink>, section 6.7
     に基づき)quoted-printable 文字列を 8 ビット文字列に変換します。
    </para>
    <para>
     8ビット(バイナリ)文字列を返します。
    </para>
    <para>
     <function>imap_8bit</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-8bit">
   <refnamediv>
    <refname>imap_8bit</refname>
    <refpurpose>
     8bit 文字列を quoted-printable 文字列に変換する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_8bit</function></funcdef>
      <paramdef>string <parameter>string</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     (<ulink url="&url.rfc;rfc2045.html">RFC2045</ulink>, section 6.7
     に基づき)8bit 文字列をquoted-printable文字列に変換します。
    </para>
    <para>
     quoted-printable文字列を返します。
    </para>
    <para>
     <function>imap_qprint</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-binary">
   <refnamediv>
    <refname>imap_binary</refname>
     <refpurpose>8ビット文字列をbase64文字列に変換する</refpurpose>
   </refnamediv>
    <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_binary</function></funcdef>
      <paramdef>string <parameter>string</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     (<ulink url="&url.rfc;rfc2045.html">RFC2045</ulink>,Section 6.8に
     基づき)8ビット文字列をbase64文字列に変換します。
    </para>
    <para>
     base64 文字列を返します。
    </para>
    <para>
     <function>imap_base64</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-scanmailbox">
   <refnamediv>
     <refname>imap_scanmailbox</refname>
    <refpurpose>
     メールボックスのリストを読み、メールボックスのテキストにおいて
     文字列を検索する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_scanmailbox</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>content</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     メールボックスのテキストに<parameter>content</parameter>があるメー
     ルボックスの名前を有する配列を返します。この関数は
     <function>imap_listmailbox</function>に似ていますが、メールボック
     スのデータ中に文字列<parameter>content</parameter>が存在するかど
     うかの確認も行います。
    </para>
   </refsect1>
  </refentry>
  
  <refentry id="function.imap-mailboxmsginfo">
   <refnamediv>
    <refname>imap_mailboxmsginfo</refname>
    <refpurpose>現在のメールボックスに関する情報を得る</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_mailboxmsginfo</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     現在のメールボックスに関する情報を返します。
     失敗した場合にfalseを返します。
    </para>
    <para>  
     <function>imap_mailboxmsginfo</function> 関数は、
     サーバーにおける現在のメールボックスのステータスを調べ、
     次のプロパティを有するオブジェクトの情報を返します。
     この関数は<function>imap_status</function>に似ていますが、
     メールボックスの中の全てのメッセージのサイズを合計します。
     このため、実行時間は幾分余計にかかります。
    </para>
    <para>
     <table>
      <title>mailboxのプロパティ</title>
      <tgroup cols="2">
       <tbody>
         <row>
	 <entry>Date   </entry>
	 <entry>最終変更日</entry>
	</row>
         <row>
	 <entry>Driver </entry>
	 <entry>ドライバ</entry>
	</row>
         <row>
	 <entry>Mailbox</entry>
	 <entry>メールボックスの名前</entry>
	</row>
	<row>
	 <entry>Nmsgs  </entry>
	 <entry>メッセージ数</entry>
	</row>
	<row>
	 <entry>Recent </entry>
	 <entry>最近のメッセージの数</entry>
	</row>
         <row>
	 <entry>Unread </entry>
	 <entry>未読のメッセージの数</entry>
	</row>
	<row>
	 <entry>Size   </entry>
	 <entry>メールボックスのサイズ</entry>
	</row>
       </tbody>
      </tgroup>
     </table>
    </para>
    <para>
     <example>
      <title><function>imap_mailboxmsginfo</function> の例</title>
      <programlisting role="php">
&lt;?php

$mbox = imap_open("{your.imap.host}INBOX","username", "password")
      || die("can't connect: ".imap_last_error());
 
$check = imap_mailboxmsginfo($mbox);
 
if($check) {
    print "Date: "    . $check->Date    ."&lt;br>\n" ;
    print "Driver: "  . $check->Driver  ."&lt;br>\n" ;
    print "Mailbox: " . $check->Mailbox ."&lt;br>\n" ;
    print "Messages: ". $check->Nmsgs   ."&lt;br>\n" ;
    print "Recent: "  . $check->Recent  ."&lt;br>\n" ;
    print "Unread: "  . $check->Unread  ."&lt;br>\n" ;
    print "Deleted: " . $check->Deleted ."&lt;br>\n" ;
    print "Size: "    . $check->Size    ."&lt;br>\n" ;
} else {
    print "imap_check() failed: ".imap_lasterror(). "&lt;br>\n";
}
 
imap_close($mbox);

?&gt;
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-rfc822-write-address">
   <refnamediv>
    <refname>imap_rfc822_write_address</refname>
    <refpurpose>
     指定したメールボックス、ホスト、個人情報を適当にフォーマットされ
     た電子メールアドレスにして返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_rfc822_write_address</function></funcdef>
       <paramdef>string <parameter>mailbox</parameter></paramdef>
      <paramdef>string <parameter>host</parameter></paramdef>
      <paramdef>string <parameter>personal</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     指定したメールボックス、ホスト、個人情報を
     <ulink url="&url.rfc;rfc822.html">RFC822</ulink>の定義に基づき
     適当にフォーマットされた電子メールアドレスにして返します。
    </para>
    <para>
     <example>
      <title><function>imap_rfc822_write_address</function> の例</title>
      <programlisting role="php">
print imap_rfc822_write_address("hartmut","cvs.php.net","Hartmut Holzgraefe")."\n";      
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>
  
  <refentry id="function.imap-rfc822-parse-adrlist">
   <refnamediv>
    <refname>imap_rfc822_parse_adrlist</refname>
    <refpurpose>アドレス文字列を解釈します</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_rfc822_parse_adrlist</function></funcdef>
      <paramdef>string <parameter>address</parameter></paramdef>
      <paramdef>string <parameter>default_host</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、<ulink url="&url.rfc;rfc822.html">RFC822</ulink>
     の定義に基づきアドレス文字列を解釈し、各アドレス毎にオブジェクトの
     配列を返します。4 つのオブジェクトは、以下のようになります。
    </para>
    <para>
     <itemizedlist>
      <listitem>
       <simpara>
        mailbox  - メールボックス名 (ユーザ名)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        host - ホスト名
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        personal - 個人名
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        adl - ドメインソースルートからのパス
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     <example>
      <title><function>imap_rfc822_parse_adrlist</function> の例</title>
      <programlisting role="php">
$address_string = "Hartmut Holzgraefe &lt;hartmut@cvs.php.net>, postmaster@somedomain.net, root";
$address_array  = imap_rfc822_parse_adrlist($address_string,"somedomain.net");
if(! is_array($address_array)) die("somethings wrong\n");
 
reset($address_array);
while(list($key,$val)=each($address_array)){
  print "mailbox : ".$val->mailbox."&lt;br>\n";
  print "host    : ".$val->host."&lt;br>\n";
  print "personal: ".$val->personal."&lt;br>\n";
  print "adl     : ".$val->adl."&lt;p>\n";
} 
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-setflag-full">
   <refnamediv>
    <refname>imap_setflag_full</refname>
    <refpurpose>メッセージにフラグをセットする</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_setflag_full</function></funcdef>
      <paramdef>int <parameter>stream</parameter></paramdef>
      <paramdef>string <parameter>sequence</parameter></paramdef>
      <paramdef>string <parameter>flag</parameter></paramdef>
      <paramdef>string <parameter>options</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、指定したシーケンスのメッセージのフラグに指定したフラグを
     セットし、保存します。
    </para>
    <para>
     設定可能なフラグは、(RFC2060で定義された) "\\Seen", "\\Answered",
     "\\Flagged", "\\Deleted", "\\Draft", "\\Recent" です。
    </para>
    <para>
     オプションはビットマスクであり、以下の組み合わせとなります。
     <informalexample>
      <literallayout>
       ST_UID          シーケンス引数はシーケンス番号の代わりに UID を
       含みます
      </literallayout>
     </informalexample>
    </para>
    <para>
     <example>
      <title><function>imap_setflag_full</function> の例</title>
      <programlisting role="php">
$mbox = imap_open ("{your.imap.host:143}","username","password")
     || die("can't connect: ".imap_last_error());
 
$status = imap_setflag_full ($mbox,"2,5","\\Seen \\Flagged");
 
print gettype ($status)."\n";
print $status."\n";
 
imap_close($mbox);
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-clearflag-full">
   <refnamediv>
    <refname>imap_clearflag_full</refname>
    <refpurpose>メッセージのフラグをクリアする</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_clearflag_full</function></funcdef>
      <paramdef>int <parameter>stream</parameter></paramdef>
      <paramdef>string <parameter>sequence</parameter></paramdef>
      <paramdef>string <parameter>flag</parameter></paramdef>
      <paramdef>string <parameter>options</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、指定したシーケンスのメッセージのフラグからに指定したフラグ
     を削除します。設定可能なフラグは、(RFC2060で定義された) "\\Seen",
     "\\Answered", "\\Flagged", "\\Deleted", "\\Draft", "\\Recent" です。
    </para>
    <para>
     オプションはビットマスクであり、以下の組み合わせとなります。
     <informalexample>
      <literallayout>
       ST_UID          シーケンス引数はシーケンス番号の代わりに UID を含みます
      </literallayout>
     </informalexample>
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-sort">
   <refnamediv>
    <refname>imap_sort</refname>
    <refpurpose></refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_sort</function></funcdef>
      <paramdef>int <parameter>stream</parameter></paramdef>
      <paramdef>int <parameter>criteria</parameter></paramdef>
      <paramdef>int <parameter>reverse</parameter></paramdef>
      <paramdef>int <parameter>options</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     指定したパラメータによりソートされたメッセージ番号の配列を
     返します。
    </para>
    <para>
     逆順にソートする場合は、reverse を 1 にします。
    </para>
    <para>
     criteria は、次のどれかとします。(一つのみ)
     <informalexample>
      <literallayout>
SORTDATE        メッセージの日付
SORTARRIVAL     到着日付
SORTFROM        最初の From アドレスのメールボックス
SORTSUBJECT     メッセージ Subject
SORTTO          最初の To アドレスのメールボックス
SORTCC          最初の cc アドレスのメールボックス
SORTSIZE        メッセージのサイズ
      </literallayout>
     </informalexample>
    </para>
     <para>
     フラグはビットマスクであり、次の組み合わせとjります。
     <informalexample>
      <literallayout>
SE_UID          シーケンス番号の変わりに UID を返す
SE_NOPREFETCH   検索したメッセージを事前取得しない
      </literallayout>
     </informalexample>
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-fetchheader">
   <refnamediv>
    <refname>imap_fetchheader</refname>
    <refpurpose>メッセージのヘッダを返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string<function>imap_fetchheader</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int <parameter>msgno</parameter></paramdef>
      <paramdef>int <parameter>flags</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、指定したメッセージのヘッダーを完全でフィルターリング
     されていない<ulink url="&url.rfc;rfc822.html">RFC822</ulink>フォー
     マットのテキスト文字列として取得し、テキスト文字列を返します。
    </para>
    <para>
     オプションは次のようになります。
     <informalexample>
      <literallayout>
FT_UID          msgno 引数は UID である 
FT_INTERNAL     返される文字列を "internal" フォーマットとする。
                ただし、CRLF 改行は例外とする。
FT_PREFETCHTEXT RFC822.TEXT は同時に事前に取得する必要があります。
       これは、メッセージテキスト全体を取得したい場合にIMAP
       接続において別の RTT を回避します。
       (例えば、"ローカルファイルに保存する"操作)
      </literallayout>
     </informalexample>
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-uid">
   <refnamediv>
    <refname>imap_uid</refname>
    <refpurpose>
     指定したメッセージシーケンス番号の UID を返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_uid</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int <parameter>msgno</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、指定したメッセージシーケンス番号の UID を返します。
     メッセージ番号はメールボックスの内容を変更する度に変わる可能性が
     ありますが、UIDはユニークなIDであり時間が経過しても変わりません。
     この関数は、<function>imap_msgno</function> の逆関数です。
    </para>
   </refsect1>
  </refentry>
  
  <refentry id="function.imap-msgno">
   <refnamediv>
    <refname>imap_msgno</refname>
    <refpurpose>指定したUIDのメッセージ番号を返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>imap_msgno</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>int <parameter>uid</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、指定したUIDメッセージ番号を返します。
     これは、<function>imap_uid</function> の逆の動作となります。
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-search">
   <refnamediv>
    <refname>imap_search</refname>
    <refpurpose>
     指定した検索条件にマッチするメッセージを配列として返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_search</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>criteria</parameter></paramdef>
      <paramdef>int <parameter>flags</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、指定した imap ストリームの現在オープンしているメール
     ボックスにおいて検索を行います。<parameter>criteria</parameter>
     は、空白で区切られた文字列で、以下のキーワードが使用可能です。複
     数語のキーワード(例 FROM "joe smith")は全て引用符で括る必要があり
     ます。
     <itemizedlist>  
      <listitem>
       <simpara>
        ALL - 他の検索条件にマッチする全メッセージを返す
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        ANSWERED - \\ANSWERED フラグが設定されているメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        BCC "string" - Bcc: フィールドに "string" を有するメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        BEFORE "date" - "date" より前の Date: を有するメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        BODY "string" - メッセージ本体に "string" を有するメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        CC "string" - Cc: フィールドに "string" を有するメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        DELETED - 削除されたメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        FLAGGED - \\FLAGGED フラグが設定されっDるメッセージにマッチ
	          (重要または緊急を表すものとして使用されることがあります)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        FROM "string" - From: フィールドに "string" を有するメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        KEYWORD "string" - キーワードとして "string" を有するメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        NEW - 新規メッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        OLD - 古いメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        ON "date" - Date: が "date" であるメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        RECENT - \\RECENT フラグが設定されているメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        SEEN - (\\SEEN フラグが設定されている)既読のメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        SINCE "date" - Date: が "date" 以降であるメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        SUBJECT "string" - Subject: に "string" を有するメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        TEXT "string" - テキスト "string" を有するメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        TO "string" - To: に "string" を有するメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        UNANSWERED - 未回答のメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        UNDELETED - 削除されていないメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        UNFLAGGED - フラグが設定されていないメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        UNKEYWORD "string" - キーワード "string" を有さないメッセージにマッチ
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        UNSEEN - 未読のメッセージにマッチ
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     例えば、Mom から送られた全ての未回答のメッセージにマッチするには、
     "UNANSWERED FROM mom"を使用する必要があります。
     検索は、大文字小文字が区別されずに行われます。
     検索条件のリストは、UWクライアントのCソースコードからのものであり、
     不完全または不正確である可能性があります。
     (RFC2060, section 6.4.4も参照下さい)
    </para>
    <para>
     SE_UID が有効なフラグとして設定されている場合、
     メッセージ番号の変わりに UID を有する配列が返されます。
    </para>
   </refsect1>
  </refentry>
  
  <refentry id="function.imap-last-error">
   <refnamediv>
    <refname>imap_last_error</refname>
    <refpurpose>
     ページリクエスト時に生じた直近の IMAP エラーを返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_last_error</function></funcdef>
      <paramdef>void </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、カレントページに生じた直近のIMAPエラーメッセージの
     全文を返します。エラースタックは変更されません。
     <function>imap_last_error</function> を続けてコールした際、
     コール間に新規エラーが生じていない場合は、同じエラーが返されます。
    </para>
   </refsect1>
  </refentry>
  
  <refentry id="function.imap-errors">
   <refnamediv>
    <refname>imap_errors</refname>
    <refpurpose>
     ページのリクエストの間かエラースタックがリセットされて以来
     生じた全てのIMAPエラーを返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_errors</function></funcdef>
      <paramdef>void </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、最後に <function>imap_errors</function> コールを
     行ってからまたはそのページの処理を開始してから
     発生した全ての IMAP エラーメッセージの配列を返します。
     <function>imap_errors</function> がコールされた場合、エラースタックは
     処理後にクリアされます。
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-alerts">
   <refnamediv>
    <refname>imap_alerts</refname>
    <refpurpose>
     ページリクエストの間または最後にスタックがリセットされて以来発生した
     全てのIMAP警告メッセージを返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_alerts</function></funcdef>
      <paramdef>void </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、直近に <function>imap_alerts</function> をコールして
     以来、またはページ処理を開始して以来生成された 全 IMAP 警告メッセー
     ジの配列を得ます。<function>imap_alerts</function> がコールされた
     場合、カレントのスタックは、処理後にクリアされます。IMAP 規約では、
     これらのメッセージをユーザに渡すことが規定されています。
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.imap-status">
   <refnamediv>
    <refname>imap_status</refname>
    <refpurpose>
     現在のメールボックス以外のメールボックスのステータス情報を返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>object <function>imap_status</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>mailbox</parameter></paramdef>
      <paramdef>int <parameter>options</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、ステータス情報を有するオブジェクトを返します。
     有効なフラグは次のようになります。
     <itemizedlist>
      <listitem>
       <simpara>
        SA_MESSAGES - status->messages にメールボックスのメッセージ数を設定する
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        SA_RECENT - status->recent にメールボックスの最近のメッセージ数を設定する
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        SA_UNSEEN - status->unseen にメールボックスの未読の(新規)メッセージ数を
	            設定する
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        SA_UIDNEXT - status->uidnext にメールボックスの次のUIDを設定する
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        SA_UIDVALIDITY - メールボックスのUIDがもはや有効ではない場合に変化する
	                 定数を status->uidvalidity に設定する
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        SA_ALL - 上記のものを全f設定する
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
      status->flags にも上記の各定数に対するビットマスクが
      設定されます。
    </para>
    <para>
     <example>
      <title><function>imap_status</function> の例</title>
      <programlisting role="php">
$mbox = imap_open("{your.imap.host}","username","password",OP_HALFOPEN)
      || die("can't connect: ".imap_last_error());
 
$status = imap_status($mbox,"{your.imap.host}INBOX",SA_ALL);
if($status) {
  print("Messages:   ". $status->messages   )."&lt;br>\n";
  print("Recent:     ". $status->recent     )."&lt;br>\n";
  print("Unseen:     ". $status->unseen     )."&lt;br>\n";
  print("UIDnext:    ". $status->uidnext    )."&lt;br>\n";
  print("UIDvalidity:". $status->uidvalidity)."&lt;br>\n"; 
} else
  print "imap_status failed: ".imap_lasterror()."\n";
 
imap_close($mbox);
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-utf7-decode">
   <refnamediv>
    <refname>imap_utf7_decode</refname>
    <refpurpose>
     修正版UTF-7 エンコードされた文字列をデコードする
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_utf7_decode</function></funcdef>
      <paramdef>string <parameter>text</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>  
     修正版UTF-7の<parameter>text</parameter>を8ビットデータにデコード
     します。
    </para>
    <para>
     デコードされた8ビットデータを返します。入力文字列が有効な修正版
     UTF-7文字列でない場合はfalseを返します。修正UTF-7エンコーディング
     は、<ulink url="&url.rfc;rfc2060.html">RFC 2060</ulink>, section
     5.1.3 で定義されています。
     (元のUTF-7は<ulink url="&url.rfc;rfc1642.html">RFC1642</ulink>で
     定義されています)
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-utf7-encode">
   <refnamediv>
    <refname>imap_utf7_encode</refname>
    <refpurpose>
     8ビットデータを修正版UTF-7テキストにに変換する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_utf7_encode</function></funcdef>
      <paramdef>string <parameter>data</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     8ビットデータの<parameter>data</parameter>を修正版UTF-7テキスト
     に変換します。修正版UTF-7エンコードは
     <ulink url="&url.rfc;rfc2060.html">RFC 2060</ulink>, section 5.1.3 
     で定義されています。(オリジナルのUTF-7は<ulink
     url="&url.rfc;rfc1642.html">RFC1642</ulink>で定義されています)
    </para>
    <para>
     修正版UTF-7のテキストを返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-utf8">
   <refnamediv>
    <refname>imap_utf8</refname>
    <refpurpose>
      テキストをUTF8に変換する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_utf8</function></funcdef>
      <paramdef>string <parameter>text</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     指定した<parameter>text</parameter>を
     (<ulink url="&url.rfc;rfc2044.html">RFC2044</ulink>で定義された)
     UTF8に変換します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-fetch-overview">
   <refnamediv>
    <refname>imap_fetch_overview</refname>
    <refpurpose>
     指定したメッセージのヘッダ情報の概要を読む
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_fetch_overview</function></funcdef>
      <paramdef>int <parameter>imap_stream</parameter></paramdef>
      <paramdef>string <parameter>sequence</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数はメールヘッダを取得し、その内容の概要を返します。
     オブジェクトの配列を返します。
     各ヘッダを次のように記述するオブジェクトの配列を返します。
     <itemizedlist>
      <listitem>
       <simpara>
        subject - メッセージの題名(subject)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        from - 送信者
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        date - 送信日
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        message_id - メッセージID 
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        references - このメッセージIDへのリファレンス
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        size - サイズ(バイト数)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        uid - メールボックスにおけるこのメッセージのUID
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        msgno - メールボックスにおけるこのメッセージのメッセージ番号
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        recent - このメッセージのrecentフラグの有無
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        flagged -  このメッセージのフラグの有無
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        answered -  このメッセージの返信済フラグの有無
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        deleted -  このメッセージの削除フラグの有無
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        seen -  こメッセージの既読フラグの有無
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        draft -  このメッセージのドラフトフラグの有無
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     <example>
      <title><function>imap_fetch_overview</function> の例</title>
      <programlisting role="php">
$mbox = imap_open ("{your.imap.host:143}","username","password")
     || die("can't connect: ".imap_last_error());
 
$overview = imap_fetch_overview ($mbox,"2,4:6",0);
 
if(is_array($overview)) {
        reset($overview);
        while( list($key,$val) = each($overview)) {
                print     $val->msgno
                . " - " . $val->date
                . " - " . $val->subject
                . "\n";
        }
}
 
imap_close ($mbox);
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-mime-header-decode">
   <refnamediv>
    <refname>imap_mime_header_decode</refname>
    <refpurpose>MIMEヘッダーエレメントをデコードする</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>imap_header_decode</function></funcdef>
      <paramdef>string <parameter>text</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     関数<function>imap_mime_header_decode</function>は、非ASCIIテキス
     トのMIMEメッセージヘッダエクステンションをデコードします。
     (<ulink url="&url.rfc;rfc2047.html">RFC2047</ulink>を参照下さい) 
     デコードされた要素は、オブジェクトの配列で返されます。
     ただし、各オブジェクトは二つのプロパティ"charset"と"text"を有しています。
     要素がエンコードされていない場合、言い替えるとプレーンなUS-ASCIIの場合、
     この要素の"charset"プロパティは"default"に設定されます。
    </para>
    <para>
     <example>
      <title><function>imap_mime_header_decode</function>の例</title>
      <programlisting role="php">
$text="=?ISO-8859-1?Q?Keld_J=F8rn_Simonsen?= &lt;keld@dkuug.dk>";

$elements=imap_mime_header_decode($text);
for($i=0;$i&lt;count($elements);$i++) {
	echo "Charset: {$elements[$i]->charset}\n";
	echo "Text: {$elements[$i]->text}\n\n";
}

      </programlisting>
     </example>
    </para>
    <para>
     上の例には二つの要素があります。最初の要素はISO-8859-1、
     2番目の要素はプレーンなUS-ASCIIで事前にエンコードされています。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-mail-compose">
   <refnamediv>
    <refname>imap_mail_compose</refname>
    <refpurpose>
     指定したエンベロープおよびボディーセクションに基づきMIMEメッセー
     ジを作成
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_mail_compose</function></funcdef>
      <paramdef>array <parameter>envelope</parameter></paramdef>
      <paramdef>array <parameter>body</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
    </para>
    <para>
     <example>
      <title><function>imap_mail_compose</function> の例</title>
      <programlisting role="php">
&lt;?php

$envelope["from"]="musone@afterfive.com";
$envelope["to"]="musone@darkstar";
$envelope["cc"]="musone@edgeglobal.com";

$part1["type"]=TYPEMULTIPART;
$part1["subtype"]="mixed";

$filename="/tmp/imap.c.gz";
$fp=fopen($filename,"r");
$contents=fread($fp,filesize($filename));
fclose($fp);

$part2["type"]=TYPEAPPLICATION;
$part2["encoding"]=ENCBINARY;
$part2["subtype"]="octet-stream";
$part2["description"]=basename($filename);
$part2["contents.data"]=$contents;

$part3["type"]=TYPETEXT;
$part3["subtype"]="plain";
$part3["description"]="description3";
$part3["contents.data"]="contents.data3\n\n\n\t";

$body[1]=$part1;
$body[2]=$part2;
$body[3]=$part3;

echo nl2br(imap_mail_compose($envelope,$body));

?&gt;
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.imap-mail">
   <refnamediv>
    <refname>imap_mail</refname>
    <refpurpose>
     e-mailメッセージを送信する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>imap_mail</function></funcdef>
      <paramdef>string <parameter>to</parameter></paramdef>
      <paramdef>string <parameter>subject</parameter></paramdef>
      <paramdef>string <parameter>message</parameter></paramdef>
      <paramdef>string 
       <parameter><optional>additional_headers</optional></parameter>
      </paramdef>
      <paramdef>string 
       <parameter><optional>cc</optional></parameter>
      </paramdef>
      <paramdef>string 
       <parameter><optional>bcc</optional></parameter>
      </paramdef>
      <paramdef>string 
       <parameter><optional>rpath</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     この関数は、現在、PHP 3でのみ利用可能です。
    </para>
   </refsect1>
  </refentry>

 </reference>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
