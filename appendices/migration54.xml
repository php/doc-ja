<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 60790e812076cc5c0d4f8f1b3032273511949453 Maintainer: takagi Status: ready -->
<appendix xml:id="migration54" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>PHP 5.3.x から PHP 5.4.x への移行</title>
 <simpara>
  &manual.migration.seealso;
  <link linkend="migration5">5.0.x</link>、
  <link linkend="migration51">5.1.x</link>、
  <link linkend="migration52">5.2.x</link> および
  <link linkend="migration53">5.3.x</link> も参照ください。
 </simpara>

 <section xml:id="migration54.changes">
  <title>PHP 5.4.x における変更点</title>
  <simpara>
  <!-- Placehold for "What has changed in PHP 5.4.x". -->

  <!-- Current content for the 5.3.x changes
  
   Most improvements in PHP 5.3.x have no impact on existing code.  There are
   a <link linkend="migration53.incompatible">few incompatibilities</link>
   and <link linkend="migration53.new-features">new features</link> that should 
   be considered, and code should be tested before switching PHP
   versions in production environments.
   
   -->
  </simpara>
  <warning>
   <simpara>
    このリストは未完成です。
    PHP 5.4 がリリースされるまで頻繁に書き換えられることでしょう。
   </simpara>
  </warning>
  <simpara>
   5.3.x より古いバージョンの PHP からのアップグレードの場合は、
   以下の関連ドキュメントも参照ください。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="migration53">PHP 5.3.x への移行</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration52">PHP 5.2.x への移行</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration51">PHP 5.1.x への移行</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration5">PHP 4 から PHP 5 への移行</link>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.incompatible">
  <title>下位互換性のない変更点</title>
  <simpara>
   既存の PHP5 のコードのほとんどは変更なしで動作するはずですが、
   以下の下位互換性のない変更点については注意しましょう。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="control-structures.break"><literal>break</literal></link>
     と <link linkend="control-structures.continue"><literal>continue</literal></link>
     への引数として、変数は使えなくなりました。静的な定数を渡すようにしましょう。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="features.safe-mode"><literal>セーフモード</literal></link>
     をサポートしなくなりました。セーフモードでの動作を前提とするアプリケーションは、
     セキュリティに関する調整が必要となります。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     ハッシュアルゴリズム Salsa10 および Salsa20 が削除されました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Date 拡張モジュールにおいて、TZ 環境変数によるタイムゾーンの設定をサポートしなくなりました。
     デフォルトのタイムゾーンが設定されていない場合に推測することがなくなり、
     未設定の場合は常に "UTC" とみなすようになりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>get_magic_quotes_gpc()</function> と <function>get_magic_quotes_runtime()</function>
     は常に false を返すようになりました。<function>set_magic_quotes_runtime()</function> を実行すると
     <constant>E_CORE_ERROR</constant> が発生します。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     $a が文字列の場合に非数値のオフセット (たとえば $a['foo'])
     を指定したときに、<function>isset()</function> の返り値は false、
     そして <function>empty()</function> の返り値は true となりました。
     そして同時に warning が発生します。オフセットに double や bool そして null
     を指定した場合は notice が発生します。数値とみなせる文字列を渡した場合
     ($a['2'] など) の挙動はこれまでと変わりません。
     '12.3' や '5 and a half' のようなオフセットは非数値とみなされて warning
     が発生しますが、過去との互換性のためにそれぞれ 12 および 5 に変換されることに注意しましょう。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     null、false あるいは空文字列にプロパティを追加してオブジェクトに変換しようとすると、
     これまでのような <constant>E_STRICT</constant> エラーではなく warning が発生するようになりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     配列を文字列に変換しようとすると <constant>E_NOTICE</constant> が発生するようになりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Shadowing names of superglobals for parameter names now causes a fatal error.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   次に示すキーワードは予約語となり、関数名やクラス名などの識別子の名前として使えなくなりました。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="language.oop5.traits">trait</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     callable
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.oop5.traits">insteadof</link>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   次の関数は PHP から削除されました。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     define_syslog_variables()
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     import_request_variables()
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     session_is_registered(), session_register() および session_unregister()
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     mysqli_bind_param(), mysqli_bind_result(), mysqli_client_encoding(),  mysqli_fetch(), mysqli_param_count(),
     mysqli_get_metadata(), mysqli_send_long_data(), mysqli::client_encoding() および mysqli_stmt::stmt()
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.new-features">
  <title>新機能</title>
  <simpara>
   PHP 5.4.0 には多くの新機能が含まれています。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="language.oop5.traits">トレイト</link>のサポートが追加されました。
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.windows">
  <title>Windows版に対する変更</title>
  <simpara>
   Windows版に加えられた変更は以下の通りです。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>is_link</function> が
     Windows Vista 以降でのシンボリックリンクに対しても適切に機能するようになりました。
     それより前の Windows ではシンボリックリンクをサポートしていません。
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   Windows でのサポートが追加された関数は以下の通りです。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <!-- Placeholder for "Changes made to Windows support" -->
     
     <!-- Example for a previous versions entry for this list

     <function>checkdnsrr</function>
     
     -->
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   その他の変更:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <!-- Placeholder for "Other changes:" -->
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.sapi">
  <title>SAPI モジュールに対する変更</title>
  <itemizedlist>
   <listitem>
    <simpara>
     新しい SAPI モジュール cli-server が使えるようになりました。
    </simpara>
   </listitem>
  </itemizedlist>
  <itemizedlist>
   <listitem>
    <simpara>
     CLI オプション --rz が追加されました。指定した Zend 拡張モジュールの情報を表示します。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     対話シェル上で実行時に ini 設定を変更するためのショートカット <literal>#inisetting=value</literal> が追加されました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Apache 互換の関数 <function>apache_child_terminate()</function>、
     <function>getallheaders()</function>、<function>apache_request_headers()</function>
     および <function>apache_response_headers()</function> が FastCGI SAPI 用に追加されました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     PHP-FPM : 設定項目 <literal>process.max</literal> を追加し、FPM がフォークできるプロセスの数を制御できるようになりました。
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.deprecated">
  <title>PHP 5.4.x で推奨されなくなる機能</title>
  <simpara>
   <!-- Placeholder for "Deprecated features in PHP 5.4.x" -->
  </simpara>
  <simpara>
   INI ディレクティブで推奨されないものは以下の通りです。
   これらのひとつ以上を有効にすると、起動時に
   <constant>E_DEPRECATED</constant> エラーが発生します。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <!-- Placeholder for deprecated INI entries. -->
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   推奨されない関数
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>mysql_list_dbs()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>get_magic_quotes_gpc()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>get_magic_quotes_runtime()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mcrypt_generic_end()</function>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   推奨されない機能
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     INI 設定 <literal>magic_quotes_gpc</literal>、<literal>magic_quotes_runtime</literal> および
     <literal>magic_quotes_sybase</literal>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

<!-- Are there any undeprecated features/settings/etc. in PHP 5.4?

 <section xml:id="migration54.undeprecated">
  <title>Undeprecated features in PHP 5.3.x</title>
  <simpara>
   The <function>is_a</function> function has been undeprecated by popular
   request; it will no longer issue an <constant>E_STRICT</constant> error.
  </simpara>
 </section>
-->

 <section xml:id="migration54.parameters">
  <title>新しいパラメータ</title>
  <simpara>
   PHP 5.4 では、新しい、またはオプションのパラメータを提供する関数があります。
  </simpara>
  <simpara>PHP コア:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>scandir()</function> の sorting_order に
     <constant>SCANDIR_SORT_NONE</constant> を指定できるようになりました。
    </simpara>
   </listitem>
  </itemizedlist>

  <!-- Placeholder for "New Parameters" by books.

  <simpara><link linkend="book.json">json</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>json_encode</function>
     - Added <parameter>options</parameter>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>json_decode</function>
     - Added <parameter>depth</parameter>.
    </simpara>
   </listitem>
  </itemizedlist>
  
  -->

  <simpara>
   PHP 5.4.0 で追加されたメソッドパラメータは以下の通りです。
  </simpara>
  <simpara>PHP コア:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <!-- Placeholder for "New Parameters" for PHP Core methods. -->
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>OpenSSL:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>openssl_encrypt()</function> および <function>openssl_decrypt()</function>
     - no padding オプションが追加されました。
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.functions">
  <title>新しい関数</title>
  <simpara>
   PHP 5.4 で加わった新しい関数は以下の通りです。
  </simpara>
  <simpara>PHP コア:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>hex2bin()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>http_reponse_code()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>get_declared_traits()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>getimagesizefromstring()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>stream_set_chunk_size()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>socket_import_stream()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>trait_exists()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>header_register_callback()</function>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.spl">SPL:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>class_uses()</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.session">Session:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>session_status()</function>
    </simpara>
    <simpara>
     <function>session_register_shutdown()</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.mysqli">Mysqli:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>mysqli_error_list()</function>
    </simpara>
    <simpara>
     <function>mysqli_stmt_error_list()</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.libxml">Libxml:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>libxml_set_external_entity_loader()</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.ldap">LDAP:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>ldap_control_paged_results()</function>
    </simpara>
     <simpara>
     <function>ldap_control_paged_results_response()</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.intl">Intl:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>transliterator_create()</function>
    </simpara>
     <simpara>
     <function>transliterator_create_from_rules()</function>
    </simpara>
    <simpara>
     <function>transliterator_create_inverse()</function>
    </simpara>
    <simpara>
     <function>transliterator_get_error_code()</function>
    </simpara>
    <simpara>
     <function>transliterator_get_error_message()</function>
    </simpara>
    <simpara>
     <function>transliterator_list_ids()</function>
    </simpara>
    <simpara>
     <function>transliterator_transliterate()</function>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara>
   以下の関数はPHP本体に組み込まれました。つまり、これらは PHP を実行するオペレーティングシステムに関係なく使えるということです。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <!-- Placeholder for natively implemented functions. -->
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.new-stream-wrappers">
  <title>新しいストリームラッパー</title>
  <simpara>
   PHP 5.4.0 で加わったストリームラッパーは次の通りです。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <!-- Placeholder for "New stream wrappers". -->
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.new-stream-filters">
  <title>新しいフィルタ</title>
  <simpara>
   PHP 5.4.0 で加わったストリームフィルタは次の通りです。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <!-- Placeholder for "New stream filters". -->
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.class-constants">
  <title>新しいクラス定数</title>
  <simpara>
   PHP 5.4.0 で加わった新しいクラス定数は以下の通りです。
  </simpara>
  <simpara><link linkend="book.pdo">PDO</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>PDO::MYSQL_ATTR_SSL_CA</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PDO::MYSQL_ATTR_SSL_CAPATH</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PDO::MYSQL_ATTR_SSL_CERT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PDO::MYSQL_ATTR_SSL_CIPHER</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PDO::MYSQL_ATTR_SSL_KEY</constant>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.methods">
  <title>新しいメソッド</title>
  <simpara>
   PHP 5.4.0 で加わった新しいメソッドは以下の通りです。
  </simpara>
  <simpara><classname>XSL</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>XsltProcessor::setSecurityPrefs()</function> および
     <function>XsltProcessor::getSecurityPrefs()</function>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><classname>SPL</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>RegexIterator::getRegex()</function>
     <function>SplObjectStorage::getHash()</function>
     <function>DirectoryIterator::getExtension()</function>
     <function>SplDoublyLinkedList::serialize()</function>
     <function>SplDoublyLinkedList::unserialize()</function>
     <function>SplFileInfo::getExtension()</function>
     <function>SplFileObject::fputcsv()</function>
     <function>SplQueue::serialize()</function>
     <function>SplQueue::unserialize()</function>
     <function>SplStack::serialize()</function>
     <function>SplStack::unserialize()</function>
     <function>SplTempFileObject::fputcsv()</function>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><classname>Reflection</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>ReflectionExtension::isPersistent()</function>
     <function>ReflectionExtension::isTemporary()</function>
     <function>ReflectionClass::isCloneable()</function>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><classname>Closure</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>Closure::bind()</function>
     <function>Closure::bindTo()</function>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><classname>PDO_dblib</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>PDO::newRowset()</function>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><classname>StreamWrapper</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>StreamWrapper::stream_metadata()</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>StreamWrapper::stream_truncate()</function>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.new-extensions">
  <title>新しい拡張モジュール</title>
  <simpara>
   PHP 5.4.0 で追加された (デフォルトで含まれている) 拡張モジュールは以下の通りです。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <!-- Placeholder for "New Extensions". -->
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.removed-extensions">
  <title>削除された拡張モジュール</title>
  <simpara>
   以下に示す拡張モジュールは PECL に移動し、PHP に同梱されなくなりました。
   これらの PECL パッケージ は、ユーザーの需要に応じて作られるかが決まります。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.sqlite">sqlite</link>
     - ext/sqlite3 や ext/pdo_sqlite には影響しないことに注意しましょう。
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.extensions-other">
  <title>その他の拡張モジュールに対する変更</title>
  <simpara>
   以下の拡張モジュールは configure スクリプトの実行中に無効にすることができなくなりました。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <!-- Placeholder for "Other changes to extensions" - Cannot be disabled during build. -->
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara>
   拡張モジュールに対する振る舞いの変更や新機能は以下の通りです。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.mysqli">mysqli</link>
     - <function>mysqli_result()</function> が <link linkend="class.traversable">Traversable</link> を実装するようになりました。
    </simpara>
   </listitem>
  </itemizedlist>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ref.pdo-mysql">pdo_mysql</link>
     - MySQL クライアントライブラリ 4.1 より前のバージョンとのリンクをサポートしないようになりました。
    </simpara>
   </listitem>
  </itemizedlist>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.mysqlnd">mysqlnd</link>
     - 名前付きパイプをサポートするようになりました。
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.classes">
  <title>新しいクラス</title>
  <simpara>
   PHP 5.4.0 で新しく加わったクラスは以下の通りです。
  </simpara>
  <simpara><link linkend="book.spl">SPL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>CallbackFilterIterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>RecursiveCallbackFilterIterator</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.reflection">Reflection</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>ReflectionZendExtension</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.json">Json</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>JsonSerializable</classname> インターフェイス
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.session">Session</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>SessionHandler</classname> インターフェイス
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.snmp">Snmp</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>SNMP</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.json">Intl</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>Transliterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>Spoofchecker</classname>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.global-constants">
  <title>新しいグローバル定数</title>

  <simpara>PHP コア:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>CURLOPT_MAX_RECV_SPEED_LARGE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>CURLOPT_MAX_SEND_SPEED_LARGE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_DISALLOWED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_HTML401</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_HTML5</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_SUBSTITUTE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_XML1</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_XHTML</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPPROTO_IP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPPROTO_IPV6</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPV6_MULTICAST_HOPS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPV6_MULTICAST_IF</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPV6_MULTICAST_LOOP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IP_MULTICAST_IF</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IP_MULTICAST_LOOP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IP_MULTICAST_TTL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_BIGINT_AS_STRING</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_OBJECT_AS_ARRAY</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_PRETTY_PRINT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_UNESCAPED_SLASHES</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_UNESCAPED_UNICODE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>LIBXML_HTML_NODEFDTD</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>LIBXML_HTML_NOIMPLIED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>LIBXML_PEDANTIC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_JOIN_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_LEAVE_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_BLOCK_SOURCE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_UNBLOCK_SOURCE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_JOIN_SOURCE_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_LEAVE_SOURCE_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_CIPHER_AES_128_CBC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_CIPHER_AES_192_CBC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_CIPHER_AES_256_CBC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_RAW_DATA</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_ZERO_PADDING</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_CLEAN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_CLEANABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_DISABLED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_FINAL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_FLUSH</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_FLUSHABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_REMOVABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_STARTED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_STDFLAGS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_WRITE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_QUERY_RFC1738</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_QUERY_RFC3986</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_SESSION_ACTIVE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_SESSION_DISABLED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_SESSION_NONE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SCANDIR_SORT_ASCENDING</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SCANDIR_SORT_DESCENDING</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SCANDIR_SORT_NONE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SORT_FLAG_CASE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SORT_NATURAL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_ACCESS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_GROUP_NAME</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_OWNER</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_OWNER_NAME</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_TOUCH</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>T_CALLABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>T_INSTEADOF</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>T_TRAIT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>T_TRAIT_C</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ZLIB_ENCODING_DEFLATE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ZLIB_ENCODING_GZIP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ZLIB_ENCODING_RAW</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>U_IDNA_DOMAIN_NAME_TOO_LONG_ERROR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_CHECK_BIDI</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_CHECK_CONTEXTJ</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_NONTRANSITIONAL_TO_ASCII</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_NONTRANSITIONAL_TO_UNICODE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>INTL_IDNA_VARIANT_2003</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>INTL_IDNA_VARIANT_UTS46</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_EMPTY_LABEL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_LABEL_TOO_LONG</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_DOMAIN_NAME_TOO_LONG</constant>
    </simpara>
   </listitem>
   <listitem>
   <simpara>
     <constant>IDNA_ERROR_LEADING_HYPHEN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_TRAILING_HYPHEN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_HYPHEN_3_4</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_LEADING_COMBINING_MARK</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_DISALLOWED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_PUNYCODE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_LABEL_HAS_DOT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_INVALID_ACE_LABEL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_BIDI</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_CONTEXTJ</constant>
    </simpara>
   </listitem>
  </itemizedlist>
  
  <simpara><link linkend="book.json">Json</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>JSON_PRETTY_PRINT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_UNESCAPED_SLASHES</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_BIGINT_AS_STRING</constant>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.ini">
  <title>INI ファイルの扱いに関する変更</title>
  <simpara>
   デフォルト値が変更された ini ディレクティブは以下の通りです。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <literal>register_globals</literal> および <literal>register_long_arrays</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>allow_call_time_pass_reference</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>define_syslog_variables</literal> およびそれに関連するすべての関数
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>highlight.bg</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>session.bug_compat_42</literal> および <literal>session.bug_compat_warn</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>y2k_compliance</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>safe_mode</literal> およびそれに関連するすべてのパラメータ
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>zend.ze1_compatibility_mode</literal>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   次の ini ディレクティブが追加されました。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <literal>cli.pager</literal> および <literal>cli.prompt</literal>。
     これは、readline を使った対話シェルモードで利用するものです。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>max_input_vars</literal> - 最大で何個までの GET/POST/COOKIE 入力変数を受け付けるか。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>zend.multibyte</literal> - 新たなマルチバイトサポートの制御。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>session.upload_progress.enabled</literal>, <literal>session.upload_progress.cleanup</literal>,
     <literal>session.upload_progress.prefix</literal>, <literal>session.upload_progress.name</literal>,
     <literal>session.upload_progress.freq</literal>, <literal>session.upload_progress.min_freq</literal>     
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>enable_post_data_reading</literal> - 無効にすると、POST データの読み込みやその後の処理を行いません。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>windows_show_crt_warning</literal>
    </simpara>
   </listitem>
   </itemizedlist>
  <simpara>
   次の ini ディレクティブには変更がありました。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <literal>default_charset</literal> のデフォルトが ISO-8859-1 から UTF-8 に変わりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>session.entropy_file</literal> のデフォルトが /dev/random あるいは /dev/urandom
     となりました。これはコンパイル時に推測した結果で決まります。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>session.entropy_length</literal> のデフォルトが 32 に変わりました。
    </simpara>
   </listitem>
   </itemizedlist>
 </section>

 <section xml:id="migration54.other">
  <title>その他の変更</title>
  <itemizedlist>
   <listitem>
    <simpara>
     アップロードの進捗情報をセッションデータとして格納できるようになりました。
    </simpara>
    <simpara>
     session.entropy_file のデフォルトが /dev/urandom あるいは /dev/arandom
     になりました。コンパイル時にこのどちらかが存在すれば、それが設定されます。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>E_ALL</constant> に <constant>E_STRICT</constant> を含むようになりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.snmp">SNMP</link> が OOP API に対応しました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.openssl">OpenSSL</link> が AES に対応しました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="features.commandline">CLI SAPI</link>
     を readline サポートつきで対話的に使っているときに、
     fatal エラーが発生しても強制終了されなくなりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     パースエラー時のパーサからのメッセージや関数コール時の引数が間違っている場合の警告メッセージが改善されました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.variables.superglobals">$_SERVER['REQUEST_TIME_FLOAT']</link>
     が追加され、マイクロ秒単位の精度も取得できるようになりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     &lt;?= が常に有効になりました。<literal>short_open_tag</literal> の設定にかかわらずいつでも使えます。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     クラスのインスタンスを生成するときに、そのメンバーにアクセスできるようになりました
     (例: (new foo)-&gt;bar())。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     新しいハッシュアルゴリズム fnv132, fnv164, joaat が追加されました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     文字列のオフセットの連鎖 (たとえば $a が文字列の場合の $a[0][0]) が動作するようになりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     foo()[0] のように、関数の返り値を配列として扱えるようになりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Closures がスコープや <literal>$this</literal> をサポートするようになりました。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <type>SimpleXMLElement</type> を配列にキャストすると、
     最初にマッチしたノードだけでなくすべてのノードが含まれるようになりました。
     <function>var_dump()</function> や <function>var_export()</function> そして
     <function>print_r()</function> を使った場合に、
     <type>SimpleXMLElement</type> のすべての子が常に表示されるようになります。
    </simpara>
   </listitem>
  </itemizedlist>
 </section>
</appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
