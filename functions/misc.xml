 <reference id="ref.misc">
  <title>その他の関数</title>
  <titleabbrev>その他</titleabbrev>

  <partintro>
   <para>
    他のカテゴリには当てはまらない関数群を、こちらに収録しています。
   </para>
  </partintro>

  <refentry id="function.create-function">
   <refnamediv>
    <refname>create_function</refname>
    <refpurpose>匿名(ラムダ形式)関数を作成する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>create_function</function></funcdef>
      <paramdef>string <parameter>args</parameter></paramdef>
      <paramdef>string <parameter>code</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     指定したパラメータにより匿名関数を作成し、その関数のユニークな名
     前を返します。通常、<parameter>args</parameter> をシングルクオー
     トで括られた文字列で指定します。<parameter>code</parameter> につ
     いても同様に指定することが推奨されます。シングルクオートで括った
     文字列を使用する理由は、パース時に変数名を保護するためです。ダブ
     ルクオートを使用した場合には、<literal>\$avar</literal>のように変
     数名をエスケープする必要があります。
    </para>
    <para>
     (例えば、)実行時に取得した情報から関数を作成する際にこの関数を使
     用することが可能です。
     <example>
      <title>
       <function>create_function</function>により匿名関数を作成する
      </title>
      <programlisting role="php">
$newfunc = create_function('$a,$b','return "ln($a) + ln($b) = ".log($a * $b);');
echo "New anonymous function: $newfunc\n";
echo $newfunc(2,M_E)."\n";
// 出力
// 新規匿名関数: lambda_1
// ln(2) + ln(2.718281828459) = 1.6931471805599
      </programlisting>
     </example>
     もしくは、一般的なハンドル関数を作成するために、パラメータのリス
     トに一連の演算子を適用することも可能です。
     <example>
      <title>
       <function>create_function</function>で一般的な処理関数を作成する
      </title>
      <programlisting role="php">
function process($var1, $var2, $farr) {
    for ($f=0; $f &lt; count($farr); $f++)
    echo $farr[$f]($var1,$var2)."\n";
}

// 一連の数学関数を作成する
$f1 = 'if ($a &gt;=0) {return "b*a^2 = ".$b*sqrt($a);} else {return false;}';
$f2 = "return \"min(b^2+a, a^2,b) = \".min(\$a*\$a+\$b,\$b*\$b+\$a);";
$f3 = 'if ($a &gt; 0 &amp;&amp; $b != 0) {return "ln(a)/b = ".log($a)/$b;} else {return false;}';
$farr = array(
    create_function('$x,$y', 'return "some trig: ".(sin($x) + $x*cos($y));'),
    create_function('$x,$y', 'return "a hypotenuse: ".sqrt($x*$x + $y*$y);'),
    create_function('$a,$b', $f1),
    create_function('$a,$b', $f2),
    create_function('$a,$b', $f3)
    );

echo "\nUsing the first array of anonymous functions\n";
echo "parameters: 2.3445, M_PI\n";
process(2.3445, M_PI, $farr);

// 一連の文字列処理関数を作成する
$garr = array(
    create_function('$b,$a','if (strncmp($a,$b,3) == 0) return "** \"$a\" '.
    'and \"$b\"\n** Look the same to me! (looking at the first 3 chars)";'),
    create_function('$a,$b','; return "CRCs: ".crc32($a)." , ".crc32(b);'),
    create_function('$a,$b','; return "similar(a,b) = ".similar_text($a,$b,&$p)."($p%)";')
    );
echo "\nUsing the second array of anonymous functions\n";
process("Twas brilling and the slithy toves", "Twas the night", $garr);
      </programlisting>
     </example>
     上のコードを実行した場合、出力は次のようになります。
     <informalexample>
      <programlisting>
Using the first array of anonymous functions
parameters: 2.3445, M_PI
some trig: -1.6291725057799
a hypotenuse: 3.9199852871011
b*a^2 = 4.8103313314525
min(b^2+a, a^2,b) = 8.6382729035898
ln(a/b) = 0.27122299212594

Using the second array of anonymous functions
** "Twas the night" and "Twas brilling and the slithy toves"
** Look the same to me! (looking at the first 3 chars)
CRCs: -725381282 , 1908338681
similar(a,b) = 11(45.833333333333%)
      </programlisting>
     </informalexample>
     しかし、恐らくラムダ形式の(匿名)関数の最も一般的な使用法は、
    <function>array_walk</function> または <function>usort</function>
     を使用する場合にようにコールバック関数を作成する場合でしょう。
    <example>
     <title>コールバック関数として匿名関数を使用</title>
     <programlisting role="php">
$av = array("the ","a ","that ","this ");
array_walk($av, create_function('&$v,$k','$v = $v."mango";'));
print_r($av);  // for PHP3 use var_dump()
// 出力:
// Array
// (
//   [0] =&gt; the mango
//   [1] =&gt; a mango
//   [2] =&gt; that mango
//   [3] =&gt; this mango
// )

// 短い順にソートされた文字列の配列
$sv = array("small","larger","a big string","it is a string thing");
print_r($sv);
// 出力:
// Array
// (
//   [0] =&gt; small
//   [1] =&gt; larger
//   [2] =&gt; a big string
//   [3] =&gt; it is a string thing
// )

// 長さ順にソートする
usort($sv, create_function('$a,$b','return strlen($b) - strlen($a);'));
print_r($sv);
// 出力:
// Array
// (
//   [0] =&gt; it is a string thing
//   [1] =&gt; a big string
//   [2] =&gt; larger
//   [3] =&gt; small
// )
     </programlisting>
    </example>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.connection-aborted">
   <refnamediv>
    <refname>connection_aborted</refname>
    <refpurpose>クライアントとの接続が断となった場合にtrueを返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>connection_aborted</function></funcdef>
      <paramdef>void <parameter></parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     クライアントとの接続が断となった場合にtrueを返します。
     詳細な説明に関しては、<link linkend="features">機能 </link>に関する章の
     <link linkend="features.connection-handling">接続処理</link>
     に関する記述を参照下さい。
    </simpara>
   </refsect1>
  </refentry>

  <refentry id="function.connection-status">
   <refnamediv>
    <refname>connection_status</refname>
    <refpurpose>接続ステータスのビットフィールドを返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>connection_status</function></funcdef>
      <paramdef>void <parameter></parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     接続ステータスのビットフィールドを返します。
     詳細な説明に関しては、<link linkend="features">機能 </link>に関する章の
     <link linkend="features.connection-handling">接続処理</link>
     に関する記述を参照下さい。
    </simpara>
   </refsect1>
  </refentry>

  <refentry id="function.connection-timeout">
   <refnamediv>
    <refname>connection_timeout</refname>
    <refpurpose>スクリプトがタイムアウトした場合にtrueを返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>connection_timeout</function></funcdef>
      <paramdef>void <parameter></parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     スクリプトがタイムアウトした場合にtrueを返します。
     詳細な説明に関しては、<link linkend="features">機能 </link>に関する章の
     <link linkend="features.connection-handling">接続処理</link>
     に関する記述を参照下さい。
    </simpara>
   </refsect1>
  </refentry>
 
  <refentry id="function.define">
   <refnamediv>
    <refname>define</refname>
    <refpurpose>名前を指定して定数を定義する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>define</function></funcdef>
      <paramdef>string <parameter>name</parameter></paramdef>
      <paramdef>mixed <parameter>value</parameter></paramdef>
      <paramdef>int <parameter><optional>case_insensitive</optional></parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    
    <para>
     名前を指定して定数を定義します。定数は、以下の点以外は変数と同じです。
     <itemizedlist>
      <listitem>
       <simpara>
	定数には、名前の前にドル記号 '$' がありません。
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	定数は、変数スコープの規則によらずアクセスすることが可能です。
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	定数は、一度設定されると再定義したり、定義を消去することはできません。
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	定数はスカラー値としてのみ評価されます。
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     定数の名前は <parameter>name</parameter> により指定され、
     値は <parameter>value</parameter> により指定されます。
    </para>
    <para>
     オプションの第3のパラメータ <parameter>case_insensitive</parameter>
     も使用可能です。値 <emphasis>1</emphasis> が指定された場合、
     定数は大文字小文字を区別しなくなります。
     デフォルトの動作は、大文字小文字を区別します。例えば、
     CONSTANT と Constant は異なった値を表します。
    </para>
    <para>
     <example>
      <title>定数の定義</title>
      <programlisting role="php">
&lt;?php
define("CONSTANT", "Hello world.");
echo CONSTANT; // "Hello world."を出力します。
?&gt;
      </programlisting>
     </example>
    </para>
    <para>
     <function>define</function> は成功時にtrue、エラー発生時にfalseを
     返します。
    </para>
    <para>
     <function>defined</function>および
     <link linkend="language.constants">定数</link>の節も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.defined">
   <refnamediv>
    <refname>defined</refname>
    <refpurpose>
     指定した名前の定数が存在するかどうかを調べる
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>defined</function></funcdef>
      <paramdef>string <parameter>name</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <parameter>name</parameter> で指定した名前の定数が定義されている場合に
     true、その他の場合にfalseを返します。
    </para>
    <para>
     <function>define</function>および
     <link linkend="language.constants">定数</link> の節も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.die">
   <refnamediv>
    <refname>die</refname>
    <refpurpose>メッセージを出力し、現在のスクリプトを終了する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>die</function></funcdef>
      <paramdef>string <parameter>message</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     この言語構造は、メッセージを出力し、スクリプトの処理を終了します。
     この関数は、リターンを行いません。
    </simpara>
    <para>
     <example>
      <title>die の例</title>
      <programlisting role="php">
&lt;?php
$filename = '/path/to/data-file';
$file = fopen($filename, 'r')
  or die "ファイルunable to open file ($filename)";
?&gt;
       </programlisting>
      </example>
    </para>
    <simpara>
     <function>exit</function>も参照下さい。
    </simpara>
   </refsect1>
  </refentry>
 
  <refentry id="function.eval">
   <refnamediv>
    <refname>eval</refname>
    <refpurpose>文字列を PHP コードとして評価する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>mixed <function>eval</function></funcdef>
      <paramdef>string <parameter>code_str</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>eval</function> は、<parameter>code_str</parameter> 
     で与えられた文字列を PHP コードとして評価します。
     中でも、データベースのテキストフィールドにコードを保存し、
     後で実行するためには便利です。
    </simpara>
    <simpara>
     <function>eval</function> を使用する際、注意するべき点が
     いくつかあります。
     パーサーが <function>eval</function>の処理中に落ちないように、
     渡す文字列はセミコロンで文が終了するといった有効なPHPコード
     である必要があります。また、<parameter>code_str</parameter> の
     中の文字を適切にエスケープする必要があります。
    </simpara>
    <simpara>
     <function>eval</function>の中で値を与えた変数は、
     この後、メインスクリプトの中でもこれらの値を維持することも
     覚えておいて下さい。
    </simpara>
    <simpara>
     <literal>return</literal> 文は、文字列の評価をただちに終了します。
     PHP4では、<function>eval</function>関数の結果の値を返すために
     <literal>return</literal>を使用することが可能です。一方、PHP3では、
     <function>eval</function>の型は<literal>void</literal>であり、値
     を何も返しません。
    </simpara>
    <para>
     <example>
      <title>
       <function>eval</function>の例 - 簡単なテキストのマージ
      </title>
      <programlisting role="php">
&lt;?php
$string = 'cup';
$name = 'coffee';
$str = 'This is a $string with my $name in it.&lt;br&gt;';
echo $str;
eval( "\$str = \"$str\";" );
echo $str;
?&gt;
      </programlisting>
     </example>
    </para>
    <para>
     上の例は、以下を表示します。
     <programlisting>
This is a $string with my $name in it.
This is a cup with my coffee in it.
     </programlisting>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.exit">
   <refnamediv>
    <refname>exit</refname>
    <refpurpose>現在のスクリプトを終了します</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>exit</function></funcdef>
      <void/>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     この言語構造は、スクリプトの処理を終了します。
     この関数は、値を返しません。
    </simpara>
    <simpara>
     <function>die</function>も参照下さい。
    </simpara>
   </refsect1>
  </refentry> 

  <refentry id="function.func-get-arg">
   <refnamediv>
    <refname>func_get_arg</refname>
    <refpurpose>引数のリストから要素を1つ返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>func_get_arg</function></funcdef>
       <paramdef>int <parameter>arg_num</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     ユーザーが定義した関数の引数リストで<parameter>arg_num</parameter>
     番目の引数を返します。関数の引数はゼロから数えられます。
     <function>func_get_arg</function> は関数定義以外の場所で
     コールされた場合に警告を発生します。
    </simpara>
    <simpara>
     <parameter>arg_num</parameter> が実際に渡された引数の数よりも大きい場合、
     警告を発生し、<function>func_get_arg</function>はFALSEを返しす。
    </simpara>
    <para>
     <informalexample>
      <programlisting role="php">
&lt;?php
function foo() {
   $numargs = func_num_args();
   echo "Number of arguments: $numargs&lt;br&gt;\n";
   if ( $numargs &gt;= 2 ) {
      echo "Second argument is: " . func_get_arg( 1 ) . "&lt;br&gt;\n";
   }
} 
 
foo( 1, 2, 3 );
?&gt;
      </programlisting>
     </informalexample>
    </para>
    <simpara>
     <function>func_get_arg</function>は<function>func_num_args</function>および
     <function>func_get_args</function>と組み合わせて使用され、これにより
     ユーザ定義の関数が可変長の引数リストをとることができるようになります。
    </simpara>
    <note>
     <simpara>
      この関数はPHP4で追加されました。
     </simpara>
    </note>
   </refsect1>
  </refentry>
  
  <refentry id="function.func-get-args">
   <refnamediv>
    <refname>func_get_args</refname>
    <refpurpose>関数の引数リストを配列として返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>func_get_args</function></funcdef>
      <paramdef>void <parameter></parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     各要素がユーザ定義関数の引数リストの各メンバーに対応する配列を
     返します。
     <function>func_get_args</function>は関数定義部以外でコールされた
     場合に警告を発生します。
    </simpara>
    <para>
     <informalexample>
      <programlisting role="php">
&lt;?php
function foo() {
   $numargs = func_num_args();
   echo "Number of arguments: $numargs&lt;br&gt;\n";
   if ( $numargs &gt;= 2 ) {
      echo "Second argument is: " . func_get_arg( 1 ) . "&lt;br&gt;\n";
   }
   $arg_list = func_get_args();
   for ( $i = 0; $i &lt; $numargs; $i++ ) {
      echo "Argument $i is: " . $arg_list[$i] . "&lt;br&gt;\n";
   }
} 

foo( 1, 2, 3 );
?&gt;
      </programlisting>
     </informalexample>
    </para>
    <simpara>
     <function>func_get_args</function>は<function>func_num_args</function>
     および<function>func_get_arg</function>と組み合わせて使用され、
     これによりユーザ定義の章において可変長の引数リストを使用することが
     できるようになります。
    </simpara>
    <note>
     <simpara>
      この関数はPHP4で追加されました。
     </simpara>
    </note>
   </refsect1>
  </refentry>
 
  <refentry id="function.func-num-args">
   <refnamediv>
    <refname>func_num_args</refname>
    <refpurpose>関数に渡された引数の数を返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>func_num_args</function></funcdef>
      <paramdef>void <parameter></parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     カレントのユーザ定義関数に渡された引数の数を返します。
     <function>func_num_args</function>は関数定義部以外でコールされた
     場合に警告を発生します。
    </simpara>
    <para>
     <informalexample>
      <programlisting role="php">
&lt;?php
function foo() {
   $numargs = func_num_args();
   echo "Number of arguments: $numargs\n";
} 
 
foo( 1, 2, 3 );  // 'Number of arguments: 3'を出力します。
?&gt;
      </programlisting>
     </informalexample>
    </para>
    <simpara>
     <function>func_num_args</function>は<function>func_get_arg</function>
     および<function>func_get_args</function>と組み合わせて使用され、
     ユーザ定義関数において可変長の引数リストを使用することができるようになります。
    </simpara>
    <note>
     <simpara>
      この関数はPHP4で追加されました。
     </simpara>
    </note>
   </refsect1>
  </refentry>
  
  <refentry id="function.function-exists">
   <refnamediv>
    <refname>function_exists</refname>
    <refpurpose>
     指定した関数が定義されている場合にtrueを返す
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>function_exists</function></funcdef>
      <paramdef>string <parameter>function_name</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <parameter>function_name</parameter> について定義された関数のリストを
     確認します。指定した関数名がある場合にtrue、他の場合にfalseを返します。
    </simpara>
   </refsect1>
  </refentry>
 
  <refentry id="function.get-browser">
   <refnamediv>
    <refname>get_browser</refname>
    <refpurpose>
     ユーザのブラウザの機能を取得する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>object <function>get_browser</function></funcdef>
      <paramdef>string 
       <parameter><optional>user_agent</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>get_browser</function> は、ユーザーのブラウザの機能を定
     義します。これは、<filename>browscap.ini</filename>ファイルのブラ
     ウザ情報を調べることにより行います。デフォルトでは、
     $HTTP_USER_AGENTの値が使用されます。しかし、オプションの
     <parameter>user_agent</parameter> パラメータを
     <function>get_browser</function> に渡すことにより、これを変える
     (すなわち、他のブラウザの情報を調べる)ことが可能です。
    </simpara>
    <simpara>
     返される情報はオブジェクトであり、例えば、ブラウザのメジャーおよび
     マイナーバージョン暗号やID文字列、といった様々なデータ要素を含んでいます。
     フレーム、JavaScript、クッキー等のような機能に関する true/false の値、
     マイナーバージョン暗号やID文字列、といった様々なデータ要素を含んでいます。
    </simpara>
    <simpara>
     <filename>browscap.ini</filename> は多くのブラウザに関する情報を
     有していますが、データベースを最新に保つのはユーザーによる更新
     に依存しています。
     ファイルのフォーマット自体を見ればおおよそのことがわかります。
    </simpara>
    <para>
     次の例では、ユーザーのブラウザに関する全ての取得可能な情報
     の一覧を作成する手法に関するものです。
     <example>
      <title><function>get_browser</function>の例</title>
      <programlisting role="php">
&lt;?php
function list_array ($array) {
   while (list ($key, $value) = each ( $array ) ) {
	  $str .= "&lt;b&gt;$key:&lt;/b&gt; $value&lt;br&gt;\n";
   }
   return $str;
}
echo "$HTTP_USER_AGENT&lt;hr&gt;\n";
$browser = get_browser();
echo list_array ((array) $browser);
?&gt;
      </programlisting>
     </example>
    </para>
    <simpara>
     上のスクリプトの出力は、次のようになります。
    </simpara>
    <programlisting>
Mozilla/4.5 [en] (X11; U; Linux 2.2.9 i586)&lt;hr&gt;
&lt;b&gt;browser_name_pattern:&lt;/b&gt; Mozilla/4\.5.*&lt;br&gt;
&lt;b&gt;parent:&lt;/b&gt; Netscape 4.0&lt;br&gt;
&lt;b&gt;platform:&lt;/b&gt; Unknown&lt;br&gt;
&lt;b&gt;majorver:&lt;/b&gt; 4&lt;br&gt;
&lt;b&gt;minorver:&lt;/b&gt; 5&lt;br&gt;
&lt;b&gt;browser:&lt;/b&gt; Netscape&lt;br&gt;
&lt;b&gt;version:&lt;/b&gt; 4&lt;br&gt;
&lt;b&gt;frames:&lt;/b&gt; 1&lt;br&gt;
&lt;b&gt;tables:&lt;/b&gt; 1&lt;br&gt;
&lt;b&gt;cookies:&lt;/b&gt; 1&lt;br&gt;
&lt;b&gt;backgroundsounds:&lt;/b&gt; &lt;br&gt;
&lt;b&gt;vbscript:&lt;/b&gt; &lt;br&gt;
&lt;b&gt;javascript:&lt;/b&gt; 1&lt;br&gt;
&lt;b&gt;javaapplets:&lt;/b&gt; 1&lt;br&gt;
&lt;b&gt;activexcontrols:&lt;/b&gt; &lt;br&gt;
&lt;b&gt;beta:&lt;/b&gt; &lt;br&gt;
&lt;b&gt;crawler:&lt;/b&gt; &lt;br&gt;
&lt;b&gt;authenticodeupdate:&lt;/b&gt; &lt;br&gt;
&lt;b&gt;msn:&lt;/b&gt; &lt;br&gt;
    </programlisting>
    <simpara>
     これを動作させるためには、設定ファイルの
     <link linkend="ini.sect.browscap">browscap</link> を正しく
     <filename>browscap.ini</filename> の場所に設定しておく必要があります。
    </simpara>
    <simpara>
     (<filename>browscap.ini</filename> ファイルを取得できる場所を含む)
     より詳細な情報については、
     <ulink url="&url.php.faq;">&url.php.faq;</ulink>にあるPHP FAQを参照下さい。
    </simpara>
   </refsect1>
  </refentry>

  <refentry id="function.highlight-file">
   <refnamediv>
    <refname>highlight_file</refname>
    <refpurpose>ファイルの構文ハイライト表示</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>highlight_file</function></funcdef>
      <paramdef>string <parameter>filename</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     関数 <function>highlight_file</function>は、
     <parameter>filename</parameter>の中のコードをPHP組込の構文ハイラ
     イタで定義されたカラーを使用して構文ハイライト表示したものを出力
     します。
    </simpara>
    <para>
     <example>
      <title>URLのソースハイライト表示の作成</title>
      <simpara>
       引数として指定したスクリプトのコードをハイライト表示できるよう
       なURLを設定する際には、適したURLパターンを生成するためにApache
       の &quot;ForceType&quot; ディレクティブを使用し、見栄えの良いコー
       ドリストを表示するために関数<function>highlight_file</function>
       を使用します。
      </simpara>
      <simpara>
       httpd.confに次のような記述を追加します。
      </simpara>
      <para>
       <informalexample>
	<programlisting>
&lt;Location /source&gt;
    ForceType application/x-httpd-php
&lt;/Location&gt;
	</programlisting>
       </informalexample>
      </para>
      <simpara>
       そして、&quot;source&quot; という名前のファイルを作成し、それを
       Webのルートディレクトリに置きます。
      </simpara>
      <para>
       <programlisting role="php">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Source Display&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY BGCOLOR=&quot;white&quot;&gt;
&lt;?php
    $script = getenv (&quot;PATH_TRANSLATED&quot;);
    if(!$script) {
    echo &quot;&lt;BR&gt;&lt;B&gt;ERROR: Script Name needed&lt;/B&gt;&lt;BR&gt;&quot;;
    } else {
    if (ereg(&quot;(\.php|\.inc)$&quot;,$script)) {
	echo &quot;&lt;H1&gt;Source of: $PATH_INFO&lt;/H1&gt;\n&lt;HR&gt;\n&quot;;
	highlight_file($script);
    } else {
	echo &quot;&lt;H1&gt;ERROR: Only PHP or include script names are allowed&lt;/H1&gt;&quot;; 
    }
    }
    echo &quot;&lt;HR&gt;Processed: &quot;.date(&quot;Y/M/d H:i:s&quot;,time());
?&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
       </programlisting>
      </para>
      <simpara>
       これにより、&quot;/path/to/script.php&quot; にあるスクリプトの
       カラー表示を表示するために以下のURLを使用することができるように
       なります。
      </simpara>
      <para>
       <informalexample>
    <programlisting>
http://your.server.com/source/path/to/script.php
    </programlisting>
       </informalexample>
      </para>
     </example>
    </para>
    <simpara>
     <function>highlight_string</function>,
     <function>show_source</function>も参照下さい。
    </simpara>
   </refsect1>
  </refentry>

  <refentry id="function.highlight-string">
   <refnamediv>
    <refname>highlight_string</refname>
    <refpurpose>文字列の構文ハイライト化</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>highlight_string</function></funcdef>
      <paramdef>string <parameter>str</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>highlight_string</function> 関数は、PHP組込みの構文ハイ
     ライタで定義されたカラーを使用して<parameter>str</parameter>を構
     文ハイライト表示されたものを出力します。
    </simpara>
    <simpara>
     <function>highlight_file</function>,
     <function>show_source</function>も参照下さい。
    </simpara>
   </refsect1>
  </refentry>

  <refentry id="function.ignore-user-abort">
   <refnamediv>
    <refname>ignore_user_abort</refname>
    <refpurpose>
     クライアント接続が断となった時にスクリプトの実行を中断するかどうかを設定する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>ignore_user_abort</function></funcdef>
      <paramdef>int 
       <parameter><optional>setting</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     この関数は、クライアントとの接続断がスクリプトの実行中断を引き起こすか
     どうかを設定します。この関数は前の設定を返し、
     現在の設定を変えずに現在の設定を返すためだけのために
     引数なしでコールすることが可能です。PHPにおける接続処理の詳細な説明に関しては、
     機能の章の接続処理の節を参照下さい。
    </simpara>
   </refsect1>
  </refentry>
 
  <refentry id="function.iptcparse">
   <refnamediv>
    <refname>iptcparse</refname>
    <refpurpose>
     バイナリIPTC<ulink url="&url.iptc;">&url.iptc;</ulink>
     ブロックを処理しシングルタグにする
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>iptcparse</function></funcdef>
      <paramdef>string <parameter>iptcblock</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     この関数は、バイナリIPTCブロックを処理し、シングルタグにします。
     tagmakerをインデックス、valueを値とした配列を返します。
     エラーの場合またはIPTCデータが見つからない場合、falseを返します。
     例については<function>GetImageSize</function>を参照下さい。
    </simpara>
   </refsect1>
  </refentry>
 
  <refentry id="function.leak">
   <refnamediv>
    <refname>leak</refname>
    <refpurpose>メモリーをリークする</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>leak</function></funcdef>
      <paramdef>int <parameter>bytes</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>leak</function> は、指定した量のメモリーをリークします。
    </simpara>
    <simpara>
     この関数は、各リクエストが完了した時に "リークした" メモリーを自動的に
     取り除くメモリーマネージャをデバッグする際に便利です。
    </simpara>
   </refsect1>
  </refentry>
 
  <refentry id="function.pack">
   <refnamediv>
    <refname>pack</refname>
    <refpurpose>データをバイナリ文字列にパックする</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>pack</function></funcdef>
      <paramdef>string <parameter>format</parameter></paramdef>
      <paramdef>mixed 
       <parameter><optional>args</optional></parameter>...
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     指定された引数を <parameter>format</parameter> に基づいて
     バイナリ文字列にパックします。データを含むバイナリ文字列を返します。
    </para>
    <para>
     この関数のアイデアは、Perlからのものであり、
     フォーマット指定用コードは、Perlと全く同様に動作します。
     フォーマット文字列は、フォーマットコードの後にオプションの
     反復指定用引数が続いている形式となっています。
     反復指定用引数は、整数値または入力データの最後まで反復を指定する
     * のどちらかを指定することができます。 
     a, A, h, H の場合、反復数はそのデータ引数が取得する文字の数
     を指定します。
     反復数が @ の場合、次のデータを置く場所の絶対位置を表します。
     その他の場合、反復数はデータ引数が使われる数を指定し、
     結果のバイナリ文字列にパックされます。
     現在、実装されているものを以下に示します。
     <itemizedlist>
      <listitem>
       <simpara>
	a NUL で埋めた文字列
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	A 空白で埋めた文字列
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	h 16進文字列, 下位バイトが先
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	H 16進文字列, 上位バイトが先
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	c signed char
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	C unsigned char
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	s signed short (常に 16 ビット、マシンバイトオーダー)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	S unsigned short (常に 16 ビット、マシンバイトオーダー)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	n unsigned short (常に 16 ビット、ビッ°インディアンバイトオーダー)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	v unsigned short (常に 16 ビット、リトルインディアンオーダー)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	i signed integer (サイズおよびバイトオーダーはマシンに依存)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	I unsigned integer (サイズおよびバイトオーダーはマシンに依存)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	l signed long (常に 32 ビット、マシンバイトオーダー)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	L unsigned long (常に 32 ビット、マシンバイトオーダー)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	N unsigned long (常に 32 ビット、ビッグインディアンバイトオーダー)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	V unsigned long (常に 32 ビット、リトルインディアンバイトオーダー)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	f float (サイズおよび表現はマシン依存)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	d double (サイズおよび表現はマシン依存)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	x NUL バイト
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	X 1バイト戻る
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	@ 絶対位置まで NUL で埋める
       </simpara>
      </listitem>
     </itemizedlist>
      <example>
      <title>フォーマット文字列のパック</title>
      <programlisting role="php">
$binarydata = pack("nvc*", 0x1234, 0x5678, 65, 66);
      </programlisting>
      <para>
       この結果のバイナリ文字列は、6バイト長であり、
       バイト列 0x12, 0x34, 0x78, 0x56, 0x41, 0x42となります。
      </para>
     </example>
    </para>
    <para>
     符号付及び符号無しの区別は関数 <function>unpack</function> 
     にのみ影響を与え、関数<function>pack</function>は符号付及び
     符号無しのフォーマットコードに関して同じ結果を与えるということに注意して下さい。
    </para>
    <para>
     PHP は内部的に値をマシン依存の大きさの符号付の値として保持する
     ことにも注意して下さい。
     このように保持するには大きすぎる符号無しの値を与えた場合、
     倍精度実数に変換する際にしばしば期待外れの結果となります。
    </para>
   </refsect1>
  </refentry>
  
  <refentry id="function.register-shutdown-function">
   <refnamediv>
    <refname>register_shutdown_function</refname>
    <refpurpose>シャットダウン時に実行する関数を登録する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>register_shutdown_function</function></funcdef>
      <paramdef>string <parameter>func</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     スクリプト処理が完了した際に実行される <parameter>func</parameter> 
     という名前の関数を登録します。
    </simpara>
    <para>
     陥りやすいミス:
    </para>
    <simpara>
     この関数ではブラウザへの出力は許可されないので、
     printまたはechoのような文を使用してデバッグを行うことはできません。
    </simpara>
   </refsect1>
  </refentry>

  <refentry id="function.restore-error-handler">
   <refnamediv>
    <refname>restore_error_handler</refname>
    <refpurpose>
     以前のエラーハンドラ関数を回復する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>restore_error_handler</function></funcdef>
      <paramdef>void</paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <function>set_error_handler</function>を使用してエラーハンドラ関
     数を変更した後、元のエラーハンドラ(組込またはユーザ定義関数)に戻
     すために使用されます。
    </para>
    <para>
     <function>error_reporting</function>,
     <function>set_error_handler</function>,
     <function>trigger_error</function>,
     <function>user_error</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.serialize">
   <refnamediv>
    <refname>serialize</refname>
    <refpurpose>
     値の保存可能な表現を生成する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>serialize</function></funcdef>
      <paramdef>mixed <parameter>value</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>serialize</function> は、<parameter>value</parameter>の
     保存可能なバイトストリーム表現を含む文字列を返します。
    </simpara>
    <simpara>
     型や構造を失わずにPHPの値を保存または渡す際に有効です。
    </simpara>
    <simpara>
     シリアル化さ?た文字列をPHPの値に戻すには、
     <function>unserialize</function>を使用して下さい。
     <function>serialize</function>は型<type>integer</type>, 
     <type>double</type>,<type>string</type>,<type>array</type> 
     (多次元),<type>object</type> 
     (オブジェクトプロパティはシリアル化されますが、メソッドは失われます)
     に対応します。
    </simpara>
    <para>
     <example>
      <title><function>serialize</function>の例</title>
      <programlisting role="php">
// $session_data はカレントユーザーのセッション情報を含む多次元配列を
// 保持しています。リクエストの最後にこれをデータベースに保存するために
//  serialize() を使用します。

$conn = odbc_connect("webdb", "php", "chicken");
$stmt = odbc_prepare($conn,
                     "UPDATE sessions SET data = ? WHERE id = ?");
$sqldata = array(serialize($session_data), $PHP_AUTH_USER);
if (!odbc_execute($stmt, &$sqldata)) {
    $stmt = odbc_prepare($conn,
                         "INSERT INTO sessions (id, data) VALUES(?, ?)");
    if (!odbc_execute($stmt, &$sqldata)) {
        /* 何か問題があったようです。Bitch, whine and moan. */
    }
}
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.set-error-handler">
   <refnamediv>
    <refname>set_error_handlers</refname>
    <refpurpose>
     ユーザ定義のエラーハンドラ関数を設定する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>set_error_handler</function></funcdef>
      <paramdef>string <parameter>error_handler</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     スクリプトのエラー処理を行うユーザ関数
     (<parameter>error_handler</parameter>)を設定します。定義済のエラー
     ハンドラまたはエラーの際に false を返します。この関数は、実行時の
     エラー処理をユーザが定義するために使用します。例えば、致命的なエ
     ラーを発生した場合や、ある条件のもとに
     (<function>trigger_error</function>を使用して)エラーを発生する必
     要がある場合にデータやファイルを消去する必要があるようなアプリケー
     ションがこの場合にあたります。
    </para>
    <para>
     ユーザ関数の引数は2つ、エラーコードとエラーを記述する文字列です。
     以下の例では、エラーを発生することにより内部例外の処理を表示し、
     ユーザ定義関数によりこれを処理します。
     <example>
      <title>
       <function>set_error_handler</function>および
       <function>trigger_error</function>によるエラー処理
      </title>
      <programlisting role="php">
&lt;?php

// ユーザエラー定数による再定義 - PHP4 のみ
define(FATAL,E_USER_ERROR);
define(ERROR,E_USER_WARNING);
define(WARNING,E_USER_NOTICE);

// このスクリプトのエラー出力レベルを設定
error_reporting(FATAL + ERROR + WARNING);

// エラーハンドラ関数
function myErrorHandler ($errno, $errstr) {
    switch ($errno) {
    case FATAL:
	echo &quot;&lt;b&gt;FATAL&lt;/b&gt; [$errno] $errstr&lt;br&gt;\n&quot;;
	echo &quot;  Fatal error in line &quot;.__LINE__.&quot; of file &quot;.__FILE__;
	echo &quot;, PHP &quot;.PHP_VERSION.&quot; (&quot;.PHP_OS.&quot;)&lt;br&gt;\n&quot;;
	echo &quot;Aborting...&lt;br&gt;\n&quot;;
	exit -1;
	break;
    case ERROR:
	echo &quot;&lt;b&gt;ERROR&lt;/b&gt; [$errno] $errstr&lt;br&gt;\n&quot;;
	break;
    case WARNING:
	echo &quot;&lt;b&gt;WARNING&lt;/b&gt; [$errno] $errstr&lt;br&gt;\n&quot;;
	break;
    default:
	echo &quot;Unkown error type: [$errno] $errstr&lt;br&gt;\n&quot;;
	break;
    }
}

// エラー処理のテスト用関数
function scale_by_log ($vect, $scale) {
    if ( !is_numeric($scale) || $scale &lt;= 0 )
    trigger_error(&quot;log(x) for x &lt;= 0 is undefined, you used: scale = $scale&quot;, 
	      FATAL);
    if (!is_array($vect)) {
    trigger_error(&quot;Incorrect input vector, array of values expected&quot;, ERROR);
    return null;
    }
    for ($i=0; $i&lt;count($vect); $i++) {
    if (!is_numeric($vect[$i]))
	trigger_error(&quot;Value at position $i is not a number, using 0 (zero)&quot;, 
	      WARNING);
    $temp[$i] = log($scale) * $vect[$i];
    }
    return $temp;
}

// 定義したエラーハンドラを設定する
$old_error_handler = set_error_handler(&quot;myErrorHandler&quot;);

// エラーを発生します。まず、数値でない項目が混ざった配列を定義します。
echo &quot;vector a\n&quot;;
$a = array(2,3,&quot;foo&quot;,5.5,43.3,21.11);
print_r($a);

// 次に警告を発生するような2番目の配列を生成します。
echo &quot;----\nvector b - a warning (b = log(PI) * a)\n&quot;;
$b = scale_by_log($a, M_PI);
print_r($b);

// 配列の代わりに文字列を渡しており、問題を発生します。
echo &quot;----\nvector c - an error\n&quot;;
$c = scale_by_log(&quot;not array&quot;,2.3);
var_dump($c);

// ゼロまたは負数の log が定義されないという致命的なエラーを発生します。
echo &quot;----\nvector d - fatal error\n&quot;;
$d = scale_by_log($a, -2.5);

?&gt;
      </programlisting>
     </example>
     このサンプルスクリプトを実行すると、出力は次のようになります。
     <informalexample>
      <programlisting>
vector a
Array
(
    [0] =&gt; 2
    [1] =&gt; 3
    [2] =&gt; foo
    [3] =&gt; 5.5
    [4] =&gt; 43.3
    [5] =&gt; 21.11
)
----
vector b - a warning (b = log(PI) * a)
&lt;b&gt;WARNING&lt;/b&gt; [1024] Value at position 2 is not a number, using 0 (zero)&lt;br&gt;
Array
(
    [0] =&gt; 2.2894597716988
    [1] =&gt; 3.4341896575482
    [2] =&gt; 0
    [3] =&gt; 6.2960143721717
    [4] =&gt; 49.566804057279
    [5] =&gt; 24.165247890281
)
----
vector c - an error
&lt;b&gt;ERROR&lt;/b&gt; [512] Incorrect input vector, array of values expected&lt;br&gt;
NULL
----
vector d - fatal error
&lt;b&gt;FATAL&lt;/b&gt; [256] log(x) for x &lt;= 0 is undefined, you used: scale = -2.5&lt;br&gt;
  Fatal error in line 16 of file trigger_error.php, PHP 4.0.1pl2 (Linux)&lt;br&gt;
Aborting...&lt;br&gt;
      </programlisting>
     </informalexample>
    </para>
    <para>
     <function>error_reporting</function>,
     <function>restore_error_handler</function>,
     <function>trigger_error</function>,
     <function>user_error</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.show-source">
   <refnamediv>
    <refname>show_source</refname>
    <refpurpose>ファイルの構文ハイライト表示</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>show_source</function></funcdef>
      <paramdef>string <parameter>filename</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>show_source</function>関数は、組込みのPHP用構文ハイライ
     ト表示用に定義された色を使用して<parameter>filename</parameter>の
     構文ハイライト表示を出力します。
    </simpara>
    <note>
     <simpara>
      この関数は、関数<function>highlight_file</function>のエイリアス
      です。
     </simpara>
    </note>
    <simpara>
     <function>highlight_string</function>,
     <function>highlight_file</function>も参照下さい。
    </simpara>
   </refsect1>
  </refentry>

  <refentry id="function.sleep">
   <refnamediv>
    <refname>sleep</refname>
    <refpurpose>実行を遅延させる</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>sleep</function></funcdef>
      <paramdef>int <parameter>seconds</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     sleep 関数は、<parameter>seconds</parameter> で与えられた秒数分
     プログラムの実行を遅延させます。
    </simpara>
    <simpara>
     <function>usleep</function> も参照のこと。
    </simpara>
   </refsect1>
  </refentry>

  <refentry id="function.trigger-error">
   <refnamediv>
    <refname>trigger_error</refname>
    <refpurpose>
     ユーザレベルのエラー/警告/通知メッセージを生成する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>trigger_error</function></funcdef>
      <paramdef>string <parameter>error_msg</parameter></paramdef>
      <paramdef>int
       <parameter><optional>error_type</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     ユーザエラーを発生するために使用され、組込のエラーハンドラまたは
     新しいエラーハンドラ(<function>set_error_handler</function>)とし
     て設定済のユーザ定義関数と組み合わせて使用されます。この関数は、
     実行時の例外に特定の応答を生成する必要がある場合に有用です。
     以下に例を示します。
     <informalexample>
      <programlisting>
if (assert($divisor == 0))
   trigger_error("Cannot divide by zero", E_USER_ERROR);
      </programlisting>
     </informalexample>
     <note>
      <para>
       より、詳細な例については、
       <function>set_error_handler</function> を参照下さい。
     </para>
     </note>
    </para>
    <para>
     <function>error_reporting</function>,
     <function>set_error_handler</function>,
     <function>restore_error_handler</function>, 
     <function>user_error</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.uniqid">
   <refnamediv>
    <refname>uniqid</refname>
    <refpurpose>ユニークなIDを生成する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>uniqid</function></funcdef>
      <paramdef>string <parameter>prefix</parameter></paramdef>
      <paramdef>boolean <parameter><optional>lcg</optional></parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>uniqid</function>は、ミリ秒単位の現在時刻に基づき
     先頭辞（prefix）を付けたユニークなIDを返します。
     いくつかのホスト上で同時にIDを生成させる場合、
     全く同じミリ秒のIDが生成されるのを防ぐのにprefixが有用です。
     <parameter>prefix</parameter>には114文字までの長さを指定することができます。
    </simpara>
    <simpara>
     オプションの <parameter>lcg</parameter> パラメータが true の場合、
     <function>uniqid</function> は、より結果をユニークにするために
     "combined LCG" を返り値の最後に追加します。
    </simpara>
    <simpara>
     <parameter>prefix</parameter> を空とした場合、返される文字列の長さは、
     13文字となります。<parameter>lcg</parameter> がtrueの場合は、
     23文字となります。
    </simpara>
    <note>
     <simpara>
      <parameter>lcg</parameter> パラメータは、
      PHP 4またはPHP 3.0.13以降でのみ使用可能です。
     </simpara>
    </note>
    <para>
     ユニークなIDまたはトークンが必要な場合、そして、
     ネットワーク経由でユーザーにそのトークンを渡そうとする場合、
     次の例のようにするのが推奨されます。
     <informalexample>
      <programlisting role="php">
$token = md5 (uniqid ("")); // ランダム要素なし
$better_token = md5 (uniqid (rand())); // 推測が困難であり、より優れている。
      </programlisting>
     </informalexample>
    </para>
    <simpara>
     この例は、極めて予測困難な 32 文字のID(128ビット16進数)を
     作成します。
    </simpara>
   </refsect1>
  </refentry>

  <refentry id="function.unpack">
   <refnamediv>
    <refname>unpack</refname>
    <refpurpose>バイナリ文字列からデータを切出します</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>unpack</function></funcdef>
      <paramdef>string <parameter>format</parameter></paramdef>
      <paramdef>string <parameter>data</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <parameter>format</parameter>に基づきバイナリ文字列から
     配列に切出します。バイナリ文字列の切出された要素を保持する配列を
     返します。
    </para>
    <para>
     <function>unpack</function>の動作はPerlとわずかに異なり、
     切出されたデータは連想配列に保存されます。
     実行する際には、別のフォーマットコードとし、スラッシュ/で
     区切る必要があります。
     <example>
      <title>フォーマット文字列の<function>unpack</function></title>
      <programlisting role="php">
$array = unpack ("c2chars/nint", $binarydata);
      </programlisting>
      <para>
       結果の配列は、エントリ "chars1","chars2","int" を保持します。
      </para>
     </example>
    </para>
    <para>
     フォーマットコードに関する説明は、
     <function>pack</function> も参照下さい。
    </para>
    <para>
     PHP は内部的に整数を符号付で保持します。
     大きな値の unsigned long を切出した場合、PHP の内部で保持された値は、
     同じ大きさの符号付き整数となり、符号無しを指定して切出された場合でも
     結果は負の数となります。
    </para>
   </refsect1>
  </refentry>
 
  <refentry id="function.unserialize">
   <refnamediv>
    <refname>unserialize</refname>
    <refpurpose>保存用表現から PHP の値を生成する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>mixed <function>unserialize</function></funcdef>
      <paramdef>string <parameter>str</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>unserialize</function> は、シリアル化された変数
     (<function>serialize</function> を参照) をとり、PHP 変数値に
     戻す変換を行います。変換された値が返されます。その値は、
     <type>integer</type>, <type>double</type>,
     <type>string</type>, <type>array</type> , <type>object</type>
     とすることが可能です。
     オブジェクトがシリアル化された場合、
     返り値にそのメソッドは保存されていません。
    </simpara>
    <para>
     <example>
      <title><function>unserialize</function>の例</title>
      <programlisting role="php">
// ここで、データベースから $session_data にセッションデータをロード 
// するために unserialize() を使用します。
// この例は、<function>serialize</function> で記述された例を補足するものです。
 
$conn = odbc_connect("webdb", "php", "chicken");
$stmt = odbc_prepare($conn, "SELECT data FROM sessions WHERE id = ?");
$sqldata = array($PHP_AUTH_USER);
if (!odbc_execute($stmt, &$sqldata) || !odbc_fetch_into($stmt, &$tmp)) {
    // 実行または取得が失敗した場合、空の配列で初期化します
    $session_data = array();
} else {
    // $tmp[0] にシリアル化されたデータを保持している必要があります。
    $session_data = unserialize($tmp[0]);
    if (!is_array($session_data)) {
        // 何か問題があったため、空の配列で初期化します。
        $session_data = array();
    }
}
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.user-error">
   <refnamediv>
    <refname>user_error</refname>
    <refpurpose>
     ユーザレベルのエラー/警告/通知メッセージを発生する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>user_error</function></funcdef>
      <paramdef>string <parameter>error_msg</parameter></paramdef>
      <paramdef>int
       <parameter><optional>error_type</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     これは、<function>trigger_error</function>へのエイリアスです。
    </para>
    <para>
     <function>error_reporting</function>,
     <function>set_error_handler</function>,
     <function>restore_error_handler</function>, 
     <function>trigger_error</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.usleep">
   <refnamediv>
    <refname>usleep</refname>
    <refpurpose>マイクロ秒単位で実行を遅延する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void <function>usleep</function></funcdef>
      <paramdef>int <parameter>micro_seconds</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>usleep</function>関数は、
     指定した <parameter>micro_seconds</parameter>の時間だけ
     プログラムの実行を遅延させます。
    </simpara>
    <simpara>
     <function>sleep</function>も参照下さい。
    </simpara>
    <note>
     <simpara>
      この関数はWindowsシステムでは動作しません。
     </simpara>
    </note>
   </refsect1>
  </refentry>

 </reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
